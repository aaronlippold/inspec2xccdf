<?xml version="1.0"?>
<Benchmark xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:dc="http://purl.org/dc/elements/1.1/" id="Elasticsearch_5-x_STIG">
  <status date="2017-09-27">accepted</status>
  <title>Elasticsearch 5.x Security Technical Implementation Guide</title>
  <description>TThis Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.</description>
  <notice id=""></notice>
  <reference href="http://iase.disa.mil">
    <dc:publisher>http://iase.disa.mil</dc:publisher>
    <dc:source>STIG.DOD.MIL</dc:source>
  </reference>
  <plain-text id="release-info">Release 1 Benchmark Date 27 Sep 2017</plain-text>
  <version>1</version>
  <Group id="V-26665">
    <title>SRG-APP-000002</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33794r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must ensure that the screen display is obfuscated when an application session lock event occurs.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000060</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch provides a unique session through REST API calls and terminates
all session and network communication at the response of every call.  Any
screen based obfustration would be provided by the operating system.  This is a
permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26666">
    <title>SRG-APP-000003</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33797r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support the requirement to initiate a session lock after an organization defined time period of system or application inactivity has transpired.</title>
      <description>&lt;VulnDiscussion&gt;The default session duration is set in the kibana.yml configuration file. By default, sessions expire after 30 minutes. The timeout is specified in milliseconds and is configurable.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000057</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch provides a unique session through REST API calls and terminates
all session and network communication at the response of every call.  A lock is
not needed since the session is already terminated.  This is a permanent not a
finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26671">
    <title>SRG-APP-000004</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33818r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must ensure that users can directly initiate session lock mechanisms which prevent further access to the system.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000058</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch provides a unique session through REST API calls and terminates
all session and network communication at the response of every call.  A lock is
not needed since the session is already terminated.  This is a permanent not a
finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26672">
    <title>SRG-APP-000005</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33819r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must have the ability to retain a session lock remaining in effect until the user re-authenticates using established identification and authentication procedures.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000056</ident>
      <fixtext fixref="N/A">Enforce logical access restrictions with changes to application
configuration.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Design the domains of administration roles within Elasticsearch
by the principle of Separation of Duties.

As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26673">
    <title>SRG-APP-000006</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33820r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must maintain and support the use of organization defined security attributes to stored information.</title>
      <description>&lt;VulnDiscussion&gt;The application controlled data model for security labels and markings should be human readable and present in all stored and transferred data models.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001399</ident>
      <fixtext fixref="N/A">As a data owner, build a data model that is denormalized or
linked security labels and markings for information such that the information
can be used for safeguarding information.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The JSON data models used by a system must maintain
denormalized or linked security labels and markings for information such that
the information can be used for safeguarding information. Data in transit is
protected via TLS. Utilize X-Pack Security's Field and Document Level Security
features to restrict access based on information within the document.

As the elasticsearch administrator, run the following CURL command:

$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is incorrect or provices access to
cluster configuration outside of administration roles, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26674">
    <title>SRG-APP-000007</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33821r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support and maintain the binding of organization defined security attributes to information in process.</title>
      <description>&lt;VulnDiscussion&gt;The application controlled data model for security labels and markings should be human readable and present in all stored and transferred data models.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001400</ident>
      <fixtext fixref="N/A">As a data owner, build a data model that is denormalized or
linked security labels and markings for information such that the information
can be used for automated policy actions by applications and Elasticsearch
security infrastructure.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The JSON data models used by a system must maintain
denormalized or linked security labels and markings for information such that
the information can be used for automated policy actions by applications and
Elasticsearch security infrastructure. Data in transit is protected via TLS.
Utilize X-Pack Security's Field and Document Level Security features to
restrict access based on information within the document.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26675">
    <title>SRG-APP-000008</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33823r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must maintain and support the use of organization defined security attributes to information in transmission.</title>
      <description>&lt;VulnDiscussion&gt;The JSON data models used by a system must maintain denormalized or linked security labels and markings for information such that the information can be used for automated policy actions by applications and Elasticsearch security infrastructure. Data in transit is protected via TLS. Utilize X-Pack Security's Field and Document Level Security features to restrict access based on information within the document.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001401</ident>
      <fixtext fixref="N/A">As a data owner, build a data model that is denormalized or
linked security labels and markings for information such that the information
can be used for automated policy actions by applications and Elasticsearch
security infrastructure.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The JSON data models used by a system must maintain
denormalized or linked security labels and markings for information such that
the information can be used for automated policy actions by applications and
Elasticsearch security infrastructure. Data in transit is protected via TLS.
Utilize X-Pack Security's Field and Document Level Security features to
restrict access based on information within the document.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26677">
    <title>SRG-APP-000010</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33849r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must provide the capability to specify administrative users and grant them the right to change application security attributes pertaining to application data.</title>
      <description>&lt;VulnDiscussion&gt;The application controlled data model for security labels and markings should be human readable and present in all stored and transferred data models.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001425</ident>
      <fixtext fixref="N/A">As an administrative users, verify that you have access to
security labels within the data model.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The JSON data models used by a system must maintain
denormalized or linked security labels and markings for information such that
the security labels can be changed by administravtive personnel. Data in
transit is protected via TLS. Utilize X-Pack Security's Field and Document
Level Security features to restrict access based on information within the
document.

As the security administrator, run the following CURL command:

$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is incorrect or does not provide
access to security labels of the underliing data model, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26678">
    <title>SRG-APP-000011</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33877r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must maintain the binding of security attributes to information with sufficient assurance that the information/attribute association can be used as the basis for automated policy actions.</title>
      <description>&lt;VulnDiscussion&gt;The JSON data models used by a system must maintain denormalized or linked security labels and markings for information such that the information can be used for automated policy actions by applications and Elasticsearch security infrastructure. Utilize X-Pack Security's Field and Document Level Security features to restrict access based on information within the document.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001426</ident>
      <fixtext fixref="N/A">As a data owner, build a data model that is denormalized or
linked security labels and markings for information such that the information
can be used for automated policy actions by applications and Elasticsearch
security infrastructure.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The JSON data models used by a system must maintain
denormalized or linked security labels and markings for information such that
the information can be used for automated policy actions by applications and
Elasticsearch security infrastructure. Data in transit is protected via TLS.
Utilize X-Pack Security's Field and Document Level Security features to
restrict access based on information within the document.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26679">
    <title>SRG-APP-000012</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33878r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The  application must allow authorized users to associate security attributes with information.</title>
      <description>&lt;VulnDiscussion&gt;The JSON data models used by a system must maintain denormalized or linked security labels and markings for information such that the information can be used for automated policy actions by applications and Elasticsearch security infrastructure. Utilize X-Pack Security's Field and Document Level Security features to restrict access based on information within the document.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001427</ident>
      <fixtext fixref="N/A">As an administrative users, verify that you have access to
security labels within the data model.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The JSON data models used by a system must maintain
denormalized or linked security labels and markings for information such that
the security labels can be changed by administravtive personnel. Data in
transit is protected via TLS. Utilize X-Pack Security's Field and Document
Level Security features to restrict access based on information within the
document.

As the security administrator, run the following CURL command:

$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is incorrect or does not provide
access to security labels of the underliing data model, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26680">
    <title>SRG-APP-000013</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33879r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must display security attributes in human-readable form on each object output from the system to system output devices to identify an organization-identified set of special dissemination, handling, or distribution instructions using organization-identified human readable, standard naming conventions.</title>
      <description>&lt;VulnDiscussion&gt;The application controlled data model for security labels and markings should be human readable and present in all stored and transferred data models.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001428</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch supports this requirement and cannot be configured to be out of
compliance. This is a permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26681">
    <title>SRG-APP-000014</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33881r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications providing remote access capabilities must utilize approved cryptography to protect the confidentiality of remote access sessions.</title>
      <description>&lt;VulnDiscussion&gt;Use SSL / TLS communication for all networked access to Elasticsearch and connected components such as Kibana and Logstash.  X-Pack Security should be configured with organization approved cryptography.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000068</ident>
      <fixtext fixref="N/A">Implement protective measures when providing remote access.


See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to protect
remote access sessions.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true

If this setting is not present or set to true, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26682">
    <title>SRG-APP-000015</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33882r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications providing remote access connectivity must use cryptography to protect the integrity of the remote access session.</title>
      <description>&lt;VulnDiscussion&gt;Use SSL / TLS communication for all networked access to Elasticsearch and connected components such as Kibana and Logstash.  X-Pack Security should be configured with organization approved cryptography.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001453</ident>
      <fixtext fixref="N/A">Implement protective measures when providing remote access.


See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to protect
remote access sessions.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true

If this setting is not present or set to true, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26684">
    <title>SRG-APP-000016</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33904r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must employ automated mechanisms to facilitate the monitoring and control of remote access methods.</title>
      <description>&lt;VulnDiscussion&gt;Collect Elasticsearch X-Pack Security audit records from all Elasticsearch nodes in near-real time to enable audit monitoring.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000067</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to audit access methods.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-F for instructions on configuring
ES_HOME.

$ cat config/elasticsearch.yml | grep xpack.security.audit

Check elasticsearch settings and documentation to determine whether designated
personnel are able to select which auditable events are being audited.


As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26685">
    <title>SRG-APP-000017</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33908r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications providing remote access must have capabilities that allow all remote access to be routed through managed access control points.</title>
      <description>&lt;VulnDiscussion&gt;Limit network access to Elasticsearch software from known points of origin with the use of software and hardware firewalls as well as X-Pack Security IP Filtering. Change the elasticsearch cluster name to an instance unique value for all elasticsearch nodes and all applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000069</ident>
      <fixtext fixref="N/A">Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-XXX for
instructions on configuring ES_HOME.

To change the Managed access control points of the application, as the
application administrator, change the following setting in elasticsearch.conf:


$ sudo su - elasticsearch
$ vi $ES_HOME/config/elasticsearch.yml

Change the Managed access control points parameter to the desired addresses,
i.e.:
     xpack.security.http.filter.enabled: true
     xpack.security.http.filter.allow: 'Managed access control points'
     xpack.security.http.filter.deny: _all

Next, restart the application:
$ sudo su - elasticsearch

# SYSTEMD SERVER ONLY
$ systemctl restart elasticsearch</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing IP filtering
rules to verify that only sepecific IP behind hardware/software 'Managed
access control points' are listed.

As the application administrator (usually elasticsearch, check the
xpack.security.http.filter setting contains IP address(es) of the  'Managed
access control points':

$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three
settings; xpack.security.http.filter.enabled: true;
xpack.security.http.filter.allow: 'Managed access control points';
xpack.security.http.filter.deny: _all

As an elasticsearch administrator test; verify runtime environment within
_culster settings are set to '{}' OR Verify all three settings are
xpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:
'Managed access control points'; xpack.security.http.filter.deny: _all

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
-XGET 'http://&lt;elasticsearch&gt;:9200/_cluster/settings'

If these configuration setting are disabled, or not pointing to the 'Managed
access control points', this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26686">
    <title>SRG-APP-000018</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33909r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must monitor for unauthorized remote connections to the information system on an organization-defined frequency.</title>
      <description>&lt;VulnDiscussion&gt;Configure X-Pack Alerting to periodically watch for unauthorized access attempts to the system in X-Pack Security audit logs and notify out to centralized incident systems and personnel.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000071</ident>
      <fixtext fixref="N/A">Modify the '/etc/rsyslog.conf' file to contain a configuration
line to send all 'rsyslog' output to a log aggregation system:

*.* @@&amp;ltlog aggregation system name&amp;gt

As System owner, configure rsyslog to monitor elasticsearch audit logs.  Run
the following command

$vi /etc/rsyslog.conf' | grep 'InputFileName
/var/log/elasticsearch/&lt;clustername&gt;_access.log'</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Moving audit information off of the systems creating the audit
events into a central location allows for the monitoring of unauthorized remote
connections on a organization-defined frequency. Verify 'rsyslog' is
configured to send all messages to a log aggregation server.

Check the configuration of 'rsyslog' with the following command:

# grep @ /etc/rsyslog.conf
   *.* @@logagg.site.mil

If there are no lines in the '/etc/rsyslog.conf' file that contain the '@'
or '@@' symbol(s), and the lines with the correct symbol(s) to send output to
another system do not cover all 'rsyslog' output, this is a finding.

As System owner, verify that elasticsearch audit logs are being monitored by
rsyslog.  Run the following command

$cat /etc/rsyslog.conf' | grep 'InputFileName
/var/log/elasticsearch/&lt;clustername&gt;_access.log'</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26687">
    <title>SRG-APP-000019</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33910r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must ensure remote sessions for accessing an organization-defined list of security functions and security-relevant information are audited.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001454</ident>
      <fixtext fixref="N/A">Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-XXX for
instructions on configuring ES_HOME.

To change the Managed access control points of the application, as the
application administrator, change the following setting in elasticsearch.conf:


$ sudo su - elasticsearch
$ vi $ES_HOME/config/elasticsearch.yml

Change the Managed access control points parameter to the desired addresses,
i.e.:
     xpack.security.http.filter.enabled: true
     xpack.security.http.filter.allow: 'Managed access control points'
     xpack.security.http.filter.deny: _all

Next, restart the application:
$ sudo su - elasticsearch

# SYSTEMD SERVER ONLY
$ systemctl restart elasticsearch</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing IP filtering
rules to verify that only sepecific IP behind hardware/software 'Managed
access control points' are listed.

As the application administrator (usually elasticsearch, check the
xpack.security.http.filter setting contains IP address(es) of the  'Managed
access control points':

$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three
settings; xpack.security.http.filter.enabled: true;
xpack.security.http.filter.allow: 'Managed access control points';
xpack.security.http.filter.deny: _all

As an elasticsearch administrator test; verify runtime environment within
_culster settings are set to '{}' OR Verify all three settings are
xpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:
'Managed access control points'; xpack.security.http.filter.deny: _all

$ curl -h content_type:application-json    -XGET
'http://&lt;elasticsearch&gt;:9200/_cluster/settings'

If these configuration setting are disabled, or not pointing to the 'Managed
access control points', this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26688">
    <title>SRG-APP-000020</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33911r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must support the capability to disable network protocols deemed by the organization to be nonsecure except for explicitly identified components in support of specific operational requirements.</title>
      <description>&lt;VulnDiscussion&gt;Limit network access to Elasticsearch software from known points of origin with the use of software and hardware firewalls as well as X-Pack Security IP Filtering. Change the elasticsearch cluster name to an instance unique value for all elasticsearch nodes and all applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001436</ident>
      <fixtext fixref="N/A">Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-XXX for
instructions on configuring ES_HOME.

To change the Managed access control points of the application, as the
application administrator, change the following setting in elasticsearch.conf:


$ sudo su - elasticsearch
$ vi $ES_HOME/config/elasticsearch.yml

Change the Managed access control points parameter to the desired addresses,
i.e.:
     xpack.security.http.filter.enabled: true
     xpack.security.http.filter.allow: 'Managed access control points'
     xpack.security.http.filter.deny: _all

Next, restart the application:
$ sudo su - elasticsearch

# SYSTEMD SERVER ONLY
$ systemctl restart elasticsearch</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing IP filtering
rules to verify that only sepecific IP behind hardware/software 'Managed
access control points' are listed.

As the application administrator (usually elasticsearch, check the
xpack.security.http.filter setting contains IP address(es) of the  'Managed
access control points':

$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three
settings; xpack.security.http.filter.enabled: true;
xpack.security.http.filter.allow: 'Managed access control points';
xpack.security.http.filter.deny: _all

As an elasticsearch administrator test; verify runtime environment within
_culster settings are set to '{}' OR Verify all three settings are
xpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:
'Managed access control points'; xpack.security.http.filter.deny: _all

$ curl -h content_type:application-json    -XGET
'http://&lt;elasticsearch&gt;:9200/_cluster/settings'

If these configuration setting are disabled, or not pointing to the 'Managed
access control points', this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26699">
    <title>SRG-APP-000023</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33942r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must provide automated mechanisms for supporting user account management. The  automated mechanisms may reside within the application itself or may be offered by the operating system or other infrastructure providing automated account management capabilities.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000015</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26701">
    <title>SRG-APP-000024</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33944r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must provide a mechanism to automatically terminate accounts designated as temporary or emergency accounts after an organization-defined time period.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000016</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26703">
    <title>SRG-APP-000025</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33946r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must be capable of automatically disabling accounts after a 35 day period of account inactivity.</title>
      <description>&lt;VulnDiscussion&gt;Configure the X-Pack Security to use a centralized authentication and authorization service such as Active Directory or LDAP in order to comply with organization defined management policies.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000017</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism to handle account disabling.

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html </fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Account disabling must be handled by an one of the supported
external authenitcation mechianism; LDAP, Active Directory, or PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.  As the
application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.

If this configuration setting does not contain logfile, this is a finding.     </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26705">
    <title>SRG-APP-000026</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33948r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must support the requirement to automatically audit account creation.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000018</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to audit account creation.


See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-F for instructions on configuring
ES_HOME.

$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs


Check elasticsearch settings and documentation to determine whether designated
personnel are able to select which auditable events are being audited.


As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26706">
    <title>SRG-APP-000027</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33949r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must support the requirement to automatically audit account modification.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001403</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism to handle account modification auditing.

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html


Configure elasticsearch audit settings to contain sufficient information to
monitor for unauthorized access.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Account termination and notification must be handled by an one
of the supported external authenitcation mechianism; LDAP, Active Directory, or
PKI and verify auditing is setup.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.  As the
application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.

If this configuration setting does not contain logfile, this is a finding.     </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26730">
    <title>SRG-APP-000028</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33978r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must automatically audit account disabling actions and notify appropriate individuals.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001404</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish account disabling.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-F for instructions on configuring
ES_HOME.

$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs


Check elasticsearch settings and documentation to determine whether designated
personnel are able to select which auditable events are being audited.


As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26731">
    <title>SRG-APP-000029</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33979r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must automatically audit account termination and notify appropriate individuals.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001405</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism to handle account termination and
notification.

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html


Configure elasticsearch audit settings to contain sufficient information to
monitor for unauthorized access.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Account termination and notification must be handled by an one
of the supported external authenitcation mechianism; LDAP, Active Directory, or
PKI and verify auditing is setup.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.  As the
application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.

If this configuration setting does not contain logfile, this is a finding.     </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26732">
    <title>SRG-APP-000030</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33980r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must support the organizational requirement to automatically monitor on atypical usage of accounts.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001356</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism to allow for monitoring of atypical account
usage.

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26733">
    <title>SRG-APP-000031</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33981r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Service Oriented Architecture (SOA) based applications must dynamically manage user privileges and associated access authorizations.</title>
      <description>&lt;VulnDiscussion&gt;Populate user metadata dynamically upon login and Implement templated RBAC policies with X-Pack Security to reflect the dynamic attributes of users. (https://www.elastic.co/guide/en/x-pack/current/field-and-document-access-control.html#templating-role-query)&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000020</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism to handle account termination and
notification.

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html


As a data owner, update your data model to contain fields that can be used to
control user privileges.

See the officieal documentation for the instructions on document and field
level security:
https://www.elastic.co/guide/en/x-pack/current/field-and-document-access-control.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>To establish dynamic privilege controls, elasticsearch relies
on external authenitcation mechanism (LADP, AD, PKI), time to live (cache.ttl),
and document/field level security.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

The default cache.ttl is 20m.

As a data owner, you can verify that your data model holds fields that can be
used to assist in privilege managment.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26734">
    <title>SRG-APP-000032</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33982r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must employ automated mechanisms enabling authorized users to make information sharing decisions based on access authorizations of sharing partners and access restrictions on information to be shared.</title>
      <description>&lt;VulnDiscussion&gt;Plan for the capability to implement Discretionary Access Control (DAC) with includes or excludes access to the single user. Utilize X-Pack Security's Field and Document Level Security features to restrict access based on information within the document.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000099</ident>
      <fixtext fixref="N/A">As a data owner, build a data model that is denormalized or
linked security labels and markings for information such that the information
can be used for automated policy actions by applications and Elasticsearch
security infrastructure.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The JSON data models used by a system must maintain
denormalized or linked security labels and markings for information such that
the information can be used for automated policy actions by applications and
Elasticsearch security infrastructure. Data in transit is protected via TLS.
Utilize X-Pack Security's Field and Document Level Security features to
restrict access based on information within the document.

As the elasticsearch administrator, run the following CURL command:

$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is incorrect or provices access to
cluster configuration outside of administration roles, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26735">
    <title>SRG-APP-000033</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33983r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must enforce approved authorizations for logical access to the system in accordance with applicable policy.</title>
      <description>&lt;VulnDiscussion&gt;Plan for granting temporary authorizations, with known automated expiration times, to enable users to implement out of the ordinary processes.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000213</ident>
      <fixtext fixref="N/A">Implement strong access controls to secure application data by
establishing role-based policies and access control mechanisms.

To establish role-based policies; see the official documentation on
authorization;
https://www.elastic.co/guide/en/x-pack/current/authorization.html.

Note: The following instructions use the ES_HOME environment variable. See
supplementary content APPENDIX-XXX for instructions on configuring ES_HOME.

To establish an access control mechanism; as the application administrator,
change the following setting in elasticsearch.conf:

$ sudo su - elasticsearch
$ vi $ES_HOME/config/elasticsearch.yml

Change the Managed access control points parameter to the desired addresses,
i.e.:
     xpack.security.http.filter.enabled: true
     xpack.security.http.filter.allow: 'Managed access control points'
     xpack.security.http.filter.deny: _all

Next, restart the application:
$ sudo su - elasticsearch

# SYSTEMD SERVER ONLY
$ systemctl restart elasticsearch</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Verify that role-based policies are in place and access
enforement mechanisms are in place.

As the elasticsearch administrator, run the following CURL command:

$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is incorrect or provices access to
cluster configuration outside of administration roles, this is a finding.

Check Elasticsearch.yml settings and existing IP filtering rules to verify that
only sepecific IP behind hardware/software 'Managed access control points'
are listed.

As the application administrator (usually elasticsearch, check the
xpack.security.http.filter setting contains IP address(es) of the  'Managed
access control points':

$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three
settings; xpack.security.http.filter.enabled: true;
xpack.security.http.filter.allow: 'Managed access control points';
xpack.security.http.filter.deny: _all

As an elasticsearch administrator test; verify runtime environment within
_culster settings are set to '{}' OR Verify all three settings are
xpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:
'Managed access control points'; xpack.security.http.filter.deny: _all

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
 -XGET 'http://&lt;elasticsearch&gt;:9200/_cluster/settings'

If these configuration setting are disabled, or not pointing to the 'Managed
access control points', this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26737">
    <title>SRG-APP-000034</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33985r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must enforce dual authorization, based on organizational policies and procedures for organization-defined privileged commands.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000021</ident>
      <fixtext fixref="N/A">Implement a Custom Realm within X-Pack security.

See the official documentation for the instructions on custom realms:
https://www.elastic.co/guide/en/x-pack/current/custom-realms.html#implementing-custom-realm</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch cannot support this requirement without
assistance from an external application, policy, or service.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26748">
    <title>SRG-APP-000035</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33996r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must enforce non-discretionary access control policies over users and resources where the policy rule set for each policy specifies: access control information (i.e., attributes) employed by the policy rule set (e.g., position, nationality, age, project, time of day).</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000022</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26751">
    <title>SRG-APP-000037</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-33999r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must prevent access to organization-defined security-relevant information except during secure, non-operable system states.</title>
      <description>&lt;VulnDiscussion&gt;Grant access to security and administrative functions of Elasticsearch only through Role Based Access Control&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000024</ident>
      <fixtext fixref="N/A">Enforce logical access restrictions with changes to application
configuration.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Design the domains of administration roles within Elasticsearch
by the principle of Separation of Duties.

As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26775">
    <title>SRG-APP-000049</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34025r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must uniquely identify source domains for information transfer.</title>
      <description>&lt;VulnDiscussion&gt;Limit network access to Elasticsearch software from known points of origin with the use of software and hardware firewalls as well as X-Pack Security IP Filtering. Change the elasticsearch cluster name to an instance unique value for all elasticsearch nodes and transport client nodes in the system.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001376</ident>
      <fixtext fixref="N/A">Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-XXX for
instructions on configuring ES_HOME.

To change the Managed access control points of the application, as the
application administrator, change the following setting in elasticsearch.conf:


$ sudo su - elasticsearch
$ vi $ES_HOME/config/elasticsearch.yml

Change the Managed access control points parameter to the desired addresses,
i.e.:
     xpack.security.http.filter.enabled: true
     xpack.security.http.filter.allow: 'Managed access control points'
     xpack.security.http.filter.deny: _all

Next, restart the application:
$ sudo su - elasticsearch

# SYSTEMD SERVER ONLY
$ systemctl restart elasticsearch</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing IP filtering
rules to verify that only sepecific IP behind hardware/software 'Managed
access control points' are listed.

As the application administrator (usually elasticsearch, check the
xpack.security.http.filter setting contains IP address(es) of the  'Managed
access control points':

$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three
settings; xpack.security.http.filter.enabled: true;
xpack.security.http.filter.allow: 'Managed access control points';
xpack.security.http.filter.deny: _all

As an elasticsearch administrator test; verify runtime environment within
_culster settings are set to '{}' OR Verify all three settings are
xpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:
'Managed access control points'; xpack.security.http.filter.deny: _all

$ curl -h content_type:application/json    -XGET
'http://&lt;elasticsearch&gt;:9200/_cluster/settings'

If these configuration setting are disabled, or not pointing to the 'Managed
access control points', this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26776">
    <title>SRG-APP-000050</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34026r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must uniquely authenticate source domains for information transfer.</title>
      <description>&lt;VulnDiscussion&gt;Limit network access to Elasticsearch software from known points of origin with the use of software and hardware firewalls as well as X-Pack Security IP Filtering. Change the elasticsearch cluster name to an instance unique value for all elasticsearch nodes and transport client nodes in the system.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001377</ident>
      <fixtext fixref="N/A">Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-XXX for
instructions on configuring ES_HOME.

To change the Managed access control points of the application, as the
application administrator, change the following setting in elasticsearch.conf:


$ sudo su - elasticsearch
$ vi $ES_HOME/config/elasticsearch.yml

Change the Managed access control points parameter to the desired addresses,
i.e.:
     xpack.security.http.filter.enabled: true
     xpack.security.http.filter.allow: 'Managed access control points'
     xpack.security.http.filter.deny: _all

Next, restart the application:
$ sudo su - elasticsearch

# SYSTEMD SERVER ONLY
$ systemctl restart elasticsearch</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing IP filtering
rules to verify that only sepecific IP behind hardware/software 'Managed
access control points' are listed.

As the application administrator (usually elasticsearch, check the
xpack.security.http.filter setting contains IP address(es) of the  'Managed
access control points':

$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three
settings; xpack.security.http.filter.enabled: true;
xpack.security.http.filter.allow: 'Managed access control points';
xpack.security.http.filter.deny: _all

As an elasticsearch administrator test; verify runtime environment within
_culster settings are set to '{}' OR Verify all three settings are
xpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:
'Managed access control points'; xpack.security.http.filter.deny: _all

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
-XGET 'http://&lt;elasticsearch&gt;:9200/_cluster/settings'

If these configuration setting are disabled, or not pointing to the 'Managed
access control points', this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26777">
    <title>SRG-APP-000051</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34027r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must uniquely identify destination domains for information transfer.</title>
      <description>&lt;VulnDiscussion&gt;Limit network access to Elasticsearch software from known points of origin with the use of software and hardware firewalls as well as X-Pack Security IP Filtering. Change the elasticsearch cluster name to an instance unique value for all elasticsearch nodes and transport client nodes in the system.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001555</ident>
      <fixtext fixref="N/A">Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-XXX for
instructions on configuring ES_HOME.

To change the Managed access control points of the application, as the
application administrator, change the following setting in elasticsearch.conf:


$ sudo su - elasticsearch
$ vi $ES_HOME/config/elasticsearch.yml

Change the Managed access control points parameter to the desired addresses,
i.e.:
     xpack.security.http.filter.enabled: true
     xpack.security.http.filter.allow: 'Managed access control points'
     xpack.security.http.filter.deny: _all

Next, restart the application:
$ sudo su - elasticsearch

# SYSTEMD SERVER ONLY
$ systemctl restart elasticsearch</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing IP filtering
rules to verify that only sepecific IP behind hardware/software 'Managed
access control points' are listed.

As the application administrator (usually elasticsearch, check the
xpack.security.http.filter setting contains IP address(es) of the  'Managed
access control points':

$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three
settings; xpack.security.http.filter.enabled: true;
xpack.security.http.filter.allow: 'Managed access control points';
xpack.security.http.filter.deny: _all

As an elasticsearch administrator test; verify runtime environment within
_culster settings are set to '{}' OR Verify all three settings are
xpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:
'Managed access control points'; xpack.security.http.filter.deny: _all

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
-XGET 'http://&lt;elasticsearch&gt;:9200/_cluster/settings'

If these configuration setting are disabled, or not pointing to the 'Managed
access control points', this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26779">
    <title>SRG-APP-000052</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34029r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must bind security attributes to information to facilitate information flow policy enforcement.</title>
      <description>&lt;VulnDiscussion&gt;The application controlled data model for security labels and markings should be human readable and present in all stored and transferred data models.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000223</ident>
      <fixtext fixref="N/A">As a data owner, build a data model that is denormalized or
linked security labels and markings for information such that the information
can be used for attribution.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The JSON data models used by a system must maintain
denormalized or linked security labels and markings for information such that
the information can be used for attribution. Data in transit is protected via
TLS. Utilize X-Pack Security's Field and Document Level Security features to
restrict access based on information within the document.

As the elasticsearch administrator, run the following CURL command:

$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is incorrect or provices access to
cluster configuration outside of administration roles, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26782">
    <title>SRG-APP-000053</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34032r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications providing information flow control must track problems associated with the binding of security attributes to data.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000224</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to audit access methods.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-F for instructions on configuring
ES_HOME.

$ cat config/elasticsearch.yml | grep xpack.security.audit

Check elasticsearch settings and documentation to determine whether designated
personnel are able to select which auditable events are being audited.


As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26786">
    <title>SRG-APP-000054</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34036r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must enforce information flow control using protected processing domains (e.g., domain type-enforcement) as a basis for flow control decisions.</title>
      <description>&lt;VulnDiscussion&gt;Limit network access to Elasticsearch software from known points of origin with the use of software and hardware firewalls as well as X-Pack Security IP Filtering. Change the elasticsearch cluster name to an instance unique value for all elasticsearch nodes and transport client nodes in the system.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000026</ident>
      <fixtext fixref="N/A">Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-XXX for
instructions on configuring ES_HOME.

To change the Managed access control points of the application, as the
application administrator, change the following setting in elasticsearch.conf:


$ sudo su - elasticsearch
$ vi $ES_HOME/config/elasticsearch.yml

Change the Managed access control points parameter to the desired addresses,
i.e.:
     xpack.security.http.filter.enabled: true
     xpack.security.http.filter.allow: 'Managed access control points'
     xpack.security.http.filter.deny: _all

Next, restart the application:
$ sudo su - elasticsearch

# SYSTEMD SERVER ONLY
$ systemctl restart elasticsearch</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing IP filtering
rules to verify that only sepecific IP behind hardware/software 'Managed
access control points' are listed.

As the application administrator (usually elasticsearch, check the
xpack.security.http.filter setting contains IP address(es) of the  'Managed
access control points':

$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three
settings; xpack.security.http.filter.enabled: true;
xpack.security.http.filter.allow: 'Managed access control points';
xpack.security.http.filter.deny: _all

As an elasticsearch administrator test; verify runtime environment within
_culster settings are set to '{}' OR Verify all three settings are
xpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:
'Managed access control points'; xpack.security.http.filter.deny: _all

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
-XGET 'http://&lt;elasticsearch&gt;:9200/_cluster/settings'

If these configuration setting are disabled, or not pointing to the 'Managed
access control points', this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26790">
    <title>SRG-APP-000056</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34040r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must prevent encrypted data from bypassing content-checking mechanisms.</title>
      <description>&lt;VulnDiscussion&gt;Limit network access to Elasticsearch software from known points of origin with the use of software and hardware firewalls as well as X-Pack Security IP Filtering. Change the elasticsearch cluster name to an instance unique value for all elasticsearch nodes and transport client nodes in the system.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000028</ident>
      <fixtext fixref="N/A">Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-XXX for
instructions on configuring ES_HOME.

To change the Managed access control points of the application, as the
application administrator, change the following setting in elasticsearch.conf:


$ sudo su - elasticsearch
$ vi $ES_HOME/config/elasticsearch.yml

Change the Managed access control points parameter to the desired addresses,
i.e.:
     xpack.security.http.filter.enabled: true
     xpack.security.http.filter.allow: 'Managed access control points'
     xpack.security.http.filter.deny: _all

Next, restart the application:
$ sudo su - elasticsearch

# SYSTEMD SERVER ONLY
$ systemctl restart elasticsearch</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing IP filtering
rules to verify that only sepecific IP behind hardware/software 'Managed
access control points' are listed.

As the application administrator (usually elasticsearch, check the
xpack.security.http.filter setting contains IP address(es) of the  'Managed
access control points':

$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three
settings; xpack.security.http.filter.enabled: true;
xpack.security.http.filter.allow: 'Managed access control points';
xpack.security.http.filter.deny: _all

As an elasticsearch administrator test; verify runtime environment within
_culster settings are set to '{}' OR Verify all three settings are
xpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:
'Managed access control points'; xpack.security.http.filter.deny: _all

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
-XGET 'http://&lt;elasticsearch&gt;:9200/_cluster/settings'

If these configuration setting are disabled, or not pointing to the 'Managed
access control points', this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26791">
    <title>SRG-APP-000057</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34041r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must enforce organization-defined limitations on the embedding of data types within other data types.</title>
      <description>&lt;VulnDiscussion&gt;The JSON data models used by a system must maintain denormalized or linked security labels and markings for information such that the information can be used for automated policy actions by applications and Elasticsearch security infrastructure. Data in transit is protected via TLS. Utilize X-Pack Security's Field and Document Level Security features to restrict access based on information within the document.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000029</ident>
      <fixtext fixref="N/A">As an administrative users, verify that you have access to
security labels within the data model.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The JSON data models used by a system must maintain
denormalized or linked security labels and markings for information such that
the security labels can be changed by administravtive personnel. Data in
transit is protected via TLS. Utilize X-Pack Security's Field and Document
Level Security features to restrict access based on information within the
document.

As the security administrator, run the following CURL command:

$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is incorrect or does not provide
access to underliing data model, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26820">
    <title>SRG-APP-000061</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34070r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>In support of information flow requirements, applications must track problems associated with information transfer.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001557</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to audit access methods.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-F for instructions on configuring
ES_HOME.

$ cat config/elasticsearch.yml | grep xpack.security.audit

Check elasticsearch settings and documentation to determine whether designated
personnel are able to select which auditable events are being audited.


As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26821">
    <title>SRG-APP-000062</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34071r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must support organizational requirements to implement separation of duties through assigned information access authorizations.</title>
      <description>&lt;VulnDiscussion&gt;Grant access to security and administrative functions of Elasticsearch only through Role Based Access Control&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000037</ident>
      <fixtext fixref="N/A">Enforce logical access restrictions with changes to application
configuration.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Design the domains of administration roles within Elasticsearch
by the principle of Separation of Duties.

As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26827">
    <title>SRG-APP-000063</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34077r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Application users must utilize a separate, distinct administrative account when accessing application security functions or security-relevant information. Non-privileged accounts must be utilized when accessing non-administrative application functions. The application must provide this functionality itself or leverage an existing technology providing this capability.</title>
      <description>&lt;VulnDiscussion&gt;Separate the access point and accounts used to administer Elasticsearch by configuring different user interfaces and issuing separate administration accounts for the use of administrators taking administrative actions. Prevent Administrative interfaces and accounts should not be used for non-administrative actions by using X-Pack's RBAC to enforce separation of duties. Audit and alert on the actions of administrator accounts to assure they are not being used for non-administrative action.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000040</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

For all other accounts, admin and non-admiistrative should be handled
externally by LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26830">
    <title>SRG-APP-000064</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34080r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must be able to function within separate processing domains (virtualized systems), when specified, so as to enable finer-grained allocation of user privileges.</title>
      <description>&lt;VulnDiscussion&gt;If desired, install Elasticsearch on virtual machines or other container technology to further encapsulate the privileges and resources allocated to the system&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000226</ident>
      <fixtext fixref="N/A">Encapsulate elasticsearch to virtual resources as organiziational
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>If organiziational required, install elasticsearch on virtual
machines or other container technology to further encapsulate the privileges
and resources allocated to the system.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26845">
    <title>SRG-APP-000095</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34125r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must produce audit records containing sufficient information to establish what type of events occurred.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000130</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26847">
    <title>SRG-APP-000096</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34127r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must produce audit records containing sufficient information to establish when (date and time) the events occurred.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000131</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26849">
    <title>SRG-APP-000097</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34129r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must produce audit records containing sufficient information to establish where the events occurred.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000132</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26851">
    <title>SRG-APP-000098</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34131r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must produce audit records containing sufficient information to establish the sources of the events.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000133</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26853">
    <title>SRG-APP-000065</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34133r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must have the capability to limit the number of failed login attempts based upon an organization defined number of consecutive invalid attempts occurring within an organization defined time period.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000044</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26855">
    <title>SRG-APP-000066</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34135r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must enforce the organization-defined time period during which the limit of consecutive invalid access attempts by a user is counted.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001452</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26856">
    <title>SRG-APP-000067</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34136r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications, when the maximum number of unsuccessful attempts are exceeded, must automatically lock the account/node for an organization-defined time period or lock the account/node until released by an administrator IAW organizational policy. </title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000047</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26860">
    <title>SRG-APP-000099</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34140r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must produce audit records that contain sufficient information to establish the outcome (success or failure) of the events.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000134</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish the outcome of an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26864">
    <title>SRG-APP-000100</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34144r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must produce audit records containing sufficient information to establish the identity of any user/subject or process associated with the event.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001487</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish the user/subject associated with an event.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26868">
    <title>SRG-APP-000101</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34148r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must include organization-defined additional, more detailed information in the audit records for audit events identified by type, location, or subject.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000135</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26871">
    <title>SRG-APP-000102</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34151r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>To support DoD requirements to centrally manage the content of audit records, applications must provide the ability to write specified audit record content to a centralized audit log repository.  </title>
      <description>&lt;VulnDiscussion&gt;Offload and centralize audit records retention to a separate system from the sources of audit records.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000136</ident>
      <fixtext fixref="N/A">Modify the '/etc/rsyslog.conf' file to contain a configuration
line to send specified 'rsyslog' output to a log aggregation system:

*.* @@&amp;ltlog aggregation system name&amp;gt

</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Verify 'rsyslog' is configured to send specified messages to
a log aggregation server.

Check the configuration of 'rsyslog' with the following command:

# grep @ /etc/rsyslog.conf
   *.* @@logagg.site.mil

If there are no lines in the '/etc/rsyslog.conf' file that contain the '@'
or '@@' symbol(s), and the lines with the correct symbol(s) to send output to
another system do not cover specified 'rsyslog' output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26879">
    <title>SRG-APP-000075</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34159r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications upon successful logon, must display to the user the date and time of the last logon (access).</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000052</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26881">
    <title>SRG-APP-000076</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34161r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>In order to inform the user of failed login attempts made with the users account, the application upon successful logon/access must display to the user the number of unsuccessful logon/access attempts since the last successful logon/access. </title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000053</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26882">
    <title>SRG-APP-000072</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34162r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must allocate audit record storage capacity.</title>
      <description>&lt;VulnDiscussion&gt;Provision adequate storage for audit records in an automated fashion based upon capacity studies for production systems.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000137</ident>
      <fixtext fixref="N/A">Audit logs are stored in the /var/log/elasticsearch/audit
directory. Ensure that it has its own partition or logical volume at
installation time, or migrate it later using LVM. Make absolutely certain that
it is large enough to store all audit logs that will be created by the auditing
daemon.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Run the following command to determine if
/var/log/elasticsearch/audit is on its own partition or logical volume:

$ mount | grep 'on /var/log/elasticsearch/audit '

If /var/log/elasticsearch/audit has its own partition or volume group, a line
will be returned. If no line is returned, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26883">
    <title>SRG-APP-000077</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34163r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>In order to inform the user of the number of successful login attempts made with the users account, the application must notify the user of the number of successful logins/accesses occurring during an organization-defined time period.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001391</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26884">
    <title>SRG-APP-000078</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34164r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must notify the user of the number of unsuccessful login/access attempts occurring during an organization-defined time period.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001392</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26886">
    <title>SRG-APP-000079</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34166r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must notify users of  organization-defined security-related changes to the user&#x89;&#xDB;&#xA1;&#xCC;&#xDD;&#xE5;&#xBB;s account occurring during the organization-defined time period.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001395</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26887">
    <title>SRG-APP-000071</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34167r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must configure their auditing to reduce the likelihood of storage capacity being exceeded.</title>
      <description>&lt;VulnDiscussion&gt;Offload and centralize audit records retention to a separate system from the sources of audit records.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000138</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

If javaascript or python plugins are installed on the machine; run uninstall
command as follows:</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit

This setting allows for the customization of audits to reduce likelihood of
exceeding storage capavity.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html      </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26888">
    <title>SRG-APP-000080</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34168r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must protect against an individual falsely denying having performed a particular action.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000166</ident>
      <fixtext fixref="N/A">Modify the '/etc/rsyslog.conf' file to contain a configuration
line to send all 'rsyslog' output to a log aggregation system:

*.* @@&amp;ltlog aggregation system name&amp;gt

</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Moving audit records to a centralized location will assist in
the investigation and non-repudiation of audited actions. Verify 'rsyslog' is
configured to send all messages to a log aggregation server.

Check the configuration of 'rsyslog' with the following command:

# grep @ /etc/rsyslog.conf
   *.* @@logagg.site.mil

If there are no lines in the '/etc/rsyslog.conf' file that contain the '@'
or '@@' symbol(s), and the lines with the correct symbol(s) to send output to
another system do not cover all 'rsyslog' output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26889">
    <title>SRG-APP-000103</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34169r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications themselves, or the logging mechanism the application utilizes, must provide a warning when allocated audit record storage volume reaches an organization-defined percentage of maximum audit record storage capacity.</title>
      <description>&lt;VulnDiscussion&gt;Monitor the health and resources (such as remaining storage) of systems running Elasticsearch software and notify operators when safety thresholds have been exceeded.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000143</ident>
      <fixtext fixref="N/A">Configure the operating system to immediately notify the SA and
ISSO (at a minimum) when allocated audit record storage volume reaches
&lt;DETERMINED_THRESHOLD&gt; percent of the repository maximum audit record storage
capacity.

Check the system configuration to determine the partition the audit records are
being written to:

# grep log_file /etc/audit/auditd.conf

Determine the size of the partition that audit records are written to (with the
example being '/var/log/elasticsearch/audit/'):

# df -h /var/log/elasticsearch/audit/

Set the value of the 'space_left' keyword in
'/etc/audit/auditd.conf' to &lt;DETERMINED_THRESHOLD&gt; percent of the
partition size.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Verify the operating system immediately notifies the SA and
ISSO (at a minimum) when allocated audit record storage volume reaches
&lt;DETERMINED_THRESHOLD&gt; percent of the repository maximum audit record storage
capacity.

Check the system configuration to determine the partition the audit records are
being written to with the following command:

# grep log_file /etc/audit/auditd.conf log_file =
/var/log/elasticsearch/audit/audit.log

Check the size of the partition that audit records are written to (with the
example being '/var/log/elasticsearch/audit/'):

# df -h /var/log/elasticsearch/audit/ 0.9G /var/log/elasticsearch/audit

If the audit records are not being written to a partition specifically created
for audit records (in this example '/var/log/elasticsearch/audit' is a
separate partition), determine the amount of space other files in the partition
are currently occupying with the following command:

# du -sh &lt;partition&gt; 1.8G /var  Determine what the threshold is for the system
to take action when &lt;DETERMINED_THRESHOLD&gt; percent of the repository maximum
audit record storage capacity is reached:

# grep -i space_left /etc/audit/auditd.conf space_left = 225

If the value of the 'space_left' keyword is not set to
ABS(1-&lt;DETERMINED_THRESHOLD&gt;) percent of the total partition size, this is a
finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26890">
    <title>SRG-APP-000081</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34170r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must associate the identity of the information producer with the information.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001338</ident>
      <fixtext fixref="N/A">Modify the '/etc/rsyslog.conf' file to contain a configuration
line to send all 'rsyslog' output to a log aggregation system:

*.* @@&amp;ltlog aggregation system name&amp;gt

</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Moving audit records to a centralized location will assist in
the investigation and non-repudiation of audited actions. Verify 'rsyslog' is
configured to send all messages to a log aggregation server.

Check the configuration of 'rsyslog' with the following command:

# grep @ /etc/rsyslog.conf
   *.* @@logagg.site.mil

If there are no lines in the '/etc/rsyslog.conf' file that contain the '@'
or '@@' symbol(s), and the lines with the correct symbol(s) to send output to
another system do not cover all 'rsyslog' output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26891">
    <title>SRG-APP-000082</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34171r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must validate the binding of the information producer&#x89;&#xDB;&#xA1;&#xCC;&#xDD;&#xE5;&#xBB;s identity to the information.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001339</ident>
      <fixtext fixref="N/A">Modify the '/etc/rsyslog.conf' file to contain a configuration
line to send all 'rsyslog' output to a log aggregation system:

*.* @@&amp;ltlog aggregation system name&amp;gt

</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Moving audit records to a centralized location will assist in
the investigation and non-repudiation of audited actions. Verify 'rsyslog' is
configured to send all messages to a log aggregation server.

Check the configuration of 'rsyslog' with the following command:

# grep @ /etc/rsyslog.conf
   *.* @@logagg.site.mil

If there are no lines in the '/etc/rsyslog.conf' file that contain the '@'
or '@@' symbol(s), and the lines with the correct symbol(s) to send output to
another system do not cover all 'rsyslog' output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26892">
    <title>SRG-APP-000104</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34172r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must provide a real-time alert when organization-defined audit failure events occur.</title>
      <description>&lt;VulnDiscussion&gt;Offload and centralize audit records retention to a separate system from the sources of audit records.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000144</ident>
      <fixtext fixref="N/A">Configure the system to provide an immediate real-time alert to
appropriate support staff when a specified audit failure occurs.

It is possible to create scripts or implement third-party tools to enable
real-time alerting for audit failures in elasticsearch.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The necessary monitoring and alerts may be implemented using
features of elasticsearch, the OS, third-party software, custom code, or a
combination of these. The term 'the system' is used to encompass all of
these.

Review the system documentation to determine which audit failure events require
real-time alerts. Review the system settings and code.

If the real-time alerting that is specified in the documentation is not
enabled, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26893">
    <title>SRG-APP-000083</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34173r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must maintain reviewer/releaser identity and credentials within the established chain of custody for all information reviewed or released.</title>
      <description>&lt;VulnDiscussion&gt;The data models used by a system must maintain reviewer/releaser identity and credentials within the object such that the information can be used for automated policy actions by applications and Elasticsearch for review or release.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001340</ident>
      <fixtext fixref="N/A">Modify the '/etc/rsyslog.conf' file to contain a configuration
line to send all 'rsyslog' output to a log aggregation system:

*.* @@&amp;ltlog aggregation system name&amp;gt

</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Moving audit records to a centralized location will assist in
the investigation and non-repudiation of audited actions. Verify 'rsyslog' is
configured to send all messages to a log aggregation server.

Check the configuration of 'rsyslog' with the following command:

# grep @ /etc/rsyslog.conf
   *.* @@logagg.site.mil

If there are no lines in the '/etc/rsyslog.conf' file that contain the '@'
or '@@' symbol(s), and the lines with the correct symbol(s) to send output to
another system do not cover all 'rsyslog' output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26894">
    <title>SRG-APP-000084</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34174r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must validate the binding of the reviewer identity to the information at the transfer/release point prior to release/transfer from one security domain to another security domain.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001341</ident>
      <fixtext fixref="N/A">Implement protective measures against unauthorized disclosure and
modification prior to transfer/release of data between security domains.

See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize protective mechanisms when
recieving/transfering from one security domain to another.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true

If this setting is not present or set to true, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26896">
    <title>SRG-APP-000086</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34176r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must provide the capability to compile audit records from multiple components within the system into a system-wide (logical or physical) audit trail that is time-correlated to within organization-defined level of tolerance.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000174</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26900">
    <title>SRG-APP-000088</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34180r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must produce a system-wide (logical or physical) audit trail composed of audit records in a standardized format.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001353</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26901">
    <title>SRG-APP-000089</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34181r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must provide audit record generation capability for defined auditable events within defined application components.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000169</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26902">
    <title>SRG-APP-000090</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34182r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must allow designated organizational personnel to select which auditable events are to be audited by specific components of the system.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000171</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-F for instructions on configuring
ES_HOME.

$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs


Check elasticsearch settings and documentation to determine whether designated
personnel are able to select which auditable events are being audited.


As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26903">
    <title>SRG-APP-000091</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34183r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must generate audit records for the DoD selected list of auditable events.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000172</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26904">
    <title>SRG-APP-000092</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34184r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must initiate session auditing upon start up.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001464</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26905">
    <title>SRG-APP-000093</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34185r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must provide the capability to capture, record, and log all content related to a user session.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001462</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish the outcome of an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26906">
    <title>SRG-APP-000094</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34186r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must provide the capability to remotely view/hear all content related to an established user session in real time.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001463</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish the outcome of an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26907">
    <title>SRG-APP-000156</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34187r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must use organization-defined replay-resistant authentication mechanisms for network access to privileged accounts.</title>
      <description>&lt;VulnDiscussion&gt;Configure PKI authentication, TLS/SSL, and cluster key features of X-pack Security so that authentication and communication within Elasticsearch is replay resistant.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000774</ident>
      <fixtext fixref="N/A">Implement approved cryptography to authenticate non-local
maintenance sessions.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to authenticate
non-local maintenance sessions.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26908">
    <title>SRG-APP-000157</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34188r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must use organization-defined replay-resistant authentication mechanisms for network access to non-privileged accounts.</title>
      <description>&lt;VulnDiscussion&gt;Configure PKI authentication, TLS/SSL, IP filtering; which are key features of X-Pack Security. This should ensure that authentication and communication within Elasticsearch is replay resistant.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000776</ident>
      <fixtext fixref="N/A">Implement integrity measures during preparation of data
transmission.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to establish
integrity during preparation of data transmission.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26909">
    <title>SRG-APP-000158</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34189r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications required to identify devices must uniquely identify and authenticate an organization-defined list of specific and/or types of devices before establishing a connection.</title>
      <description>&lt;VulnDiscussion&gt;Configure the Elasticsearch cluster to use a centralized authentication and authorization service such as Active Directory or LDAP in order to comply with organization defined management policies.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000778</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26910">
    <title>SRG-APP-000159</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34190r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications managing devices must authenticate devices before establishing remote network connections using bidirectional authentication between devices that are cryptographically based.</title>
      <description>&lt;VulnDiscussion&gt;Use SSL / TLS communication for all networked access to Elasticsearch and connected components such as Kibana and Logstash.  X-Pack Security should be configured with organization approved cryptography.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000779</ident>
      <fixtext fixref="N/A">Implement bidirectional (client-server handshake) for
establishing cryptographic communication.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize bidirectional authentication for
cryptographic device communication.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26912">
    <title>SRG-APP-000161</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34192r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications managing network connectivity must have the capability to authenticate devices before establishing network connections by using bidirectional authentication that is cryptographically based.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as valid certification path, trusted anchor.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000781</ident>
      <fixtext fixref="N/A">Implement approved cryptography to authenticate devices.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to authenticate
devices.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26913">
    <title>SRG-APP-000162</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34193r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Web services applications establishing identities at run-time for previously unknown entities must dynamically manage identifiers, attributes, and associated access authorizations.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000802</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26914">
    <title>SRG-APP-000163</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34194r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must support organizational requirements to disable user accounts after an organization-defined time period of inactivity.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000795</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26915">
    <title>SRG-APP-000164</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34195r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support organizational requirements to enforce minimum password length.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000205</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26916">
    <title>SRG-APP-000165</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34196r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support organizational requirements to prohibit password reuse for the organization-defined number of generations.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000200</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26917">
    <title>SRG-APP-000105</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34197r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must enforce configurable traffic volume thresholds representing auditing capacity for network traffic.</title>
      <description>&lt;VulnDiscussion&gt;Monitor the health and resources (such as remaining storage) of systems running Elasticsearch software and notify operators when safety thresholds have been exceeded.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000145</ident>
      <fixtext fixref="N/A">Integrate network traffic control solutions outside of
elasticsearch.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch cannot support this requirement without
assistance from an external application, policy, or service.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26918">
    <title>SRG-APP-000166</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34198r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support organizational requirements to enforce password complexity by the number of upper case characters used.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000192</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26919">
    <title>SRG-APP-000167</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34199r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support organizational requirements to enforce password complexity by the number of lower case characters used.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000193</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26920">
    <title>SRG-APP-000168</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34200r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support organizational requirements to enforce password complexity by the number of numeric characters used.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000194</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26921">
    <title>SRG-APP-000169</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34201r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support organizational requirements to enforce password complexity by the number of special characters used.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001619</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26922">
    <title>SRG-APP-000170</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34202r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support organizational requirements to enforce the number of characters that get changed when passwords are changed.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000195</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26923">
    <title>SRG-APP-000171</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34203r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support organizational requirements to enforce password encryption for storage.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000196</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26924">
    <title>SRG-APP-000172</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34204r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support organizational requirements to enforce password encryption for transmission.</title>
      <description>&lt;VulnDiscussion&gt;Use SSL / TLS communication for all networked access to Elasticsearch and connected components such as Kibana and Logstash.  X-Pack Security should be configured with organization approved cryptography.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000197</ident>
      <fixtext fixref="N/A">Implement protective measures when enforcing password encryption
for transmission.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to protect
remote access sessions.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true

If this setting is not present or set to true, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26925">
    <title>SRG-APP-000173</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34205r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must enforce password minimum lifetime restrictions.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000198</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26926">
    <title>SRG-APP-000174</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34206r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must enforce password maximum lifetime restrictions.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000199</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26927">
    <title>SRG-APP-000175</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34207r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application, when utilizing PKI-based authentication, must validate certificates by constructing a certification path with status information to an accepted trust anchor.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as valid certification path, trusted anchor, certificate revocation lists.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000185</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>When using PKI-basd authentication; the certificate path must
be validated.

$ cat config/elasticsearch.yml | grep -A 10 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'
          certificate_authorities: &lt;CA_PATH&gt;
          truststore.path: &lt;TS_PATH&gt;

If these settings are not correct or missing, this is a finding.  </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26928">
    <title>SRG-APP-000176</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34208r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application, when using PKI-based authentication, must enforce authorized access to the corresponding private key.</title>
      <description>&lt;VulnDiscussion&gt;Ensure PKI Private Key is stored with properly ACL on operating system, and the storage disks are setup with encryption-at-rest.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000186</ident>
      <fixtext fixref="N/A">Set the owner of &lt;CA_PATH&gt; and &lt;TS_PATH&gt; to the application
owner.

Change the ownership of &lt;CA_PATH&gt; to &lt;APPLICATION_OWNER&gt;, run the following
command:

$ sudo chown &lt;APPLICATION_OWNER&gt; &lt;CA_PATH&gt;

Change the ownership of &lt;TS_PATH&gt; to &lt;APPLICATION_OWNER&gt;, run the following
command:

$ sudo chown &lt;APPLICATION_OWNER&gt; &lt;TS_PATH&gt; </fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>When using PKI-basd authentication, it is critical to enforce
authorized access.

$ cat config/elasticsearch.yml | grep -A 10 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'
          certificate_authorities: &lt;CA_PATH&gt;
          truststore.path: &lt;TS_PATH&gt;

If these settings are not correct or missing, this is a finding.

To check the ownership of &lt;CA_PATH&gt;, run the command:

$ ls -lL &lt;CA_PATH&gt;

If properly configured, the output should indicate the following owner:
&lt;APPLICATION_OWNER&gt;. If it does not, this is a finding.

To check the ownership of &lt;TS_PATH&gt;, run the command:

$ ls -lL &lt;CA_PATH&gt;

If properly configured, the output should indicate the following owner:
&lt;APPLICATION_OWNER&gt;. If it does not, this is a finding.
   </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26929">
    <title>SRG-APP-000126</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34209r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must protect audit data records and integrity by using cryptographic mechanisms.</title>
      <description>&lt;VulnDiscussion&gt;Elasticsearch currently does not provide protection and integrity checks on audit logs. A secondary process would be needed to periodically roll and sign audit logs.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001350</ident>
      <fixtext fixref="N/A">Perform computation and application of a cryptographic-signed
hash using asymmetric cryptography on audit records. </fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch cannot support this requirement without
assistance from an external application, policy, or service.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26930">
    <title>SRG-APP-000177</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34210r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must ensure that PKI-based authentication maps the authenticated identity to the user account.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000187</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26932">
    <title>SRG-APP-000178</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34212r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must obscure feedback of authentication information during the authentication process to protect the information from possible exploitation/use by unauthorized individuals.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000206</ident>
      <fixtext fixref="N/A">Do not expose Elasticsearch directly to users, instead have an
application make requests on behalf of users. If this is not possible, have an
application to sanitize requests and responses from and to users.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch cannot support this requirement without
assistance from an external application, policy, or service.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26933">
    <title>SRG-APP-000127</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34213r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must protect the audit records generated as a result of remote accesses to privileged accounts and the execution of privileged functions.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001352</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to audit account creation.


See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-F for instructions on configuring
ES_HOME.

$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs


Check elasticsearch settings and documentation to determine whether designated
personnel are able to select which auditable events are being audited.


As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26934">
    <title>SRG-APP-000128</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34214r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support the enforcement of logical access restrictions associated with changes to application configuration.</title>
      <description>&lt;VulnDiscussion&gt;Separate administration rights into three groups. User Administrators, Cluster Administrators, and Index Administrators using X-Pack's RBAC and limiting access to system user; like elastic, and configuration files with operating system controls. Administrators of each type should not be given global administration controls outside of their job function.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000345</ident>
      <fixtext fixref="N/A">Enforce logical access restrictions with changes to application
configuration.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Design the domains of administration roles within Elasticsearch
by the principle of Separation of Duties.

As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26935">
    <title>SRG-APP-000179</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34215r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must use mechanisms for authentication to a cryptographic module that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for such authentication.</title>
      <description>&lt;VulnDiscussion&gt;Configure X-Pack to use an organization approved FIPS 140-2 java cryptography provider.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000803</ident>
      <fixtext fixref="N/A">Employ approved cryptography that complying with applicable
federal laws, Executive Orders, directives, policies, regulations, standards,
and guidance.

See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography that complying
with applicable federal laws, Executive Orders, directives, policies,
regulations, standards, and guidance.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:

If this setting is not present, or not set to FIPS-validated or NSA-approved
cryptography, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26937">
    <title>SRG-APP-000180</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34217r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must uniquely identify and authenticate non-organizational users (or processes acting on behalf of non-organizational users).</title>
      <description>&lt;VulnDiscussion&gt;As appropriate, grant Role Based Access Control for organizational users, non-organizational users, and anonymous users.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000804</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26938">
    <title>SRG-APP-000129</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34218r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support the organizational requirement to employ automated mechanisms enforcing access restrictions.</title>
      <description>&lt;VulnDiscussion&gt;Configure automated alarms to proactively notify when the security or stability of the system is threatened&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000346</ident>
      <fixtext fixref="N/A">Enforce logical access restrictions with changes to application
configuration.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch enforces access restrictions based on Role Based
Acces Control. Other access controls should be handled by the Operating System.


As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

As the elasticsearch administrator, run the following CURL command:

$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is incorrect or provices access to
cluster configuration outside of administration roles, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26940">
    <title>SRG-APP-000130</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34220r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support the employment of automated mechanisms supporting the auditing of enforcement actions.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000347</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to support the auditing of
enformement actions.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-F for instructions on configuring
ES_HOME.

$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs


Check elasticsearch settings and documentation to determine whether designated
personnel are able to select which auditable events are being audited.


As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26943">
    <title>SRG-APP-000131</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34224r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must prevent the installation of organization-defined critical software programs not signed with a certificate that has been recognized and approved by the organization.</title>
      <description>&lt;VulnDiscussion&gt;Elastic components should be installed from approved and controlled copies of the software only.  The binary hashes of the approved software (down to the patch level) should be routinely check according to the policies of the organization.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000352</ident>
      <fixtext fixref="N/A">Elastic components should be installed from approved and
controlled copies of the software only.

See the official documentation for RPM installation at:
https://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch, Inc. signs all of packages with the
Elasticsearch Signing Key (PGP key D88E42B4, available from
https://pgp.mit.edu) with fingerprint:

4609 5ACC 8548 582C 1A26 99A9 D27D 666C D88E 42B4

As the system owner, download and install the public signing key and verify the
package:

rpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch
rpm -K elasticsearch

Review the response, if it does not respond with md5 gpg OK, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26945">
    <title>SRG-APP-NA</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34227r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The organization must employ automated mechanisms to restrict the use of maintenance tools to authorized personnel only.</title>
      <description>&lt;VulnDiscussion&gt;Isolate maintenance functions from non-maintenance functions(Cluster health) with the use of RBAC under the principle of least privilege. Maintenance users should not be granted roles and privileges beyond what is necessary to diagnose the system.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000872</ident>
      <fixtext fixref="N/A">Enforce logical access restrictions with changes to application
configuration.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Design the domains of administration roles within Elasticsearch
by the principle of Separation of Duties.

As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26947">
    <title>SRG-APP-NA</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34229r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The organization must audit non-local maintenance and diagnostic sessions.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000880</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to audit non-local
maintenacne and diagnositic sessions.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26948">
    <title>SRG-APP-000183</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34231r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications used for non-local maintenance sessions must protect those sessions through the use of a strong authenticator tightly bound to the user.</title>
      <description>&lt;VulnDiscussion&gt;Configure X-Pack to use an organization approved FIPS 140-2 java cryptography provider.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000884</ident>
      <fixtext fixref="N/A">Implement approved cryptography to authenticate non-local
maintenance sessions.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to authenticate
non-local maintenance sessions.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26949">
    <title>SRG-APP-000133</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34232r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must limit privileges to change the software resident within software libraries (including privileged programs).</title>
      <description>&lt;VulnDiscussion&gt;Install or Upgrade Elasticsearch software with an operating system account restricted to appropriate users and configured to have only the permissions necessary to complete the installation or upgrade.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001499</ident>
      <fixtext fixref="N/A">As the system administrator, change the permissions of ES_HOME.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Design the domains of administration roles within Elasticsearch
by the principle of Separation of Duties.

As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If any files are not owned by the application owner or have permissions
allowing others to modify (write) configuration files, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26952">
    <title>SRG-APP-000134</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34235r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must automatically implement organization-defined safeguards and countermeasures if security functions (or mechanisms) are changed inappropriately.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001500</ident>
      <fixtext fixref="N/A">This is a permanent finding.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>This requirement is a permanent finding and cannot be fixed. An
appropriate mitigation for the system must be implemented but this finding
cannot be considered fixed.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26953">
    <title>SRG-APP-000184</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34236r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must employ cryptographic mechanisms to protect the integrity and confidentiality of non-local maintenance and diagnostic communications.</title>
      <description>&lt;VulnDiscussion&gt;Configure X-Pack Security to use an organization approved FIPS 140-2 java cryptography provider.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000888</ident>
      <fixtext fixref="N/A">Implement protective measures when protecting integrity and
confidentiality.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to protect the
integrity and confidentiality.
As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26954">
    <title>SRG-APP-000185</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34237r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must employ strong identification and authentication techniques when establishing non-local maintenance and diagnostic sessions</title>
      <description>&lt;VulnDiscussion&gt;Configure X-Pack Security to use an organization approved FIPS 140-2 java cryptography provider.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000877</ident>
      <fixtext fixref="N/A">Implement protective measures when identifing and authenticating
non-local sessions.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to establish
string identification and authentication techniques.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26961">
    <title>SRG-APP-000141</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34246r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must adhere to the principles of least functionality by providing only essential capabilities.</title>
      <description>&lt;VulnDiscussion&gt;Separate administration rights into three groups. User Administrators, Cluster Administrators, and Index Administrators using X-Pack's RBAC and limiting access to System accounts and configuration files with operating system controls. Administrators of each type should not be given global administration controls outside of their job function.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000381</ident>
      <fixtext fixref="N/A">Enforce logical access restrictions with changes to application
configuration.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Design the domains of administration roles within Elasticsearch
by the principle of Separation of Duties.

As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26962">
    <title>SRG-APP-000142</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34247r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support the organizational requirements to specifically prohibit or restrict the use of unauthorized functions, ports, protocols, and/or services.</title>
      <description>&lt;VulnDiscussion&gt;Configure Elasticsearch to only use ports and protocols acceptable by organization policies. Disable the HTTP, Thrift, or Transport protocols if they are unused and verify that they are configured to bind only to acceptable network devices on acceptable ports as documented in the system's security plan.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000382</ident>
      <fixtext fixref="N/A">Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-XXX for
instructions on configuring ES_HOME.

To change the Managed access control points of the application, as the
application administrator, change the following setting in elasticsearch.conf:


$ sudo su - elasticsearch
$ vi $ES_HOME/config/elasticsearch.yml

Change the Managed access control points parameter to the desired addresses,
i.e.:
     xpack.security.http.filter.enabled: true
     xpack.security.http.filter.allow: 'Managed access control points'
     xpack.security.http.filter.deny: _all

Next, restart the application:
$ sudo su - elasticsearch

# SYSTEMD SERVER ONLY
$ systemctl restart elasticsearch</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing IP filtering
rules to verify that only sepecific IP behind hardware/software 'Managed
access control points' are listed.

As the application administrator (usually elasticsearch, check the
xpack.security.http.filter setting contains IP address(es) of the  'Managed
access control points':

$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three
settings; xpack.security.http.filter.enabled: true;
xpack.security.http.filter.allow: 'Managed access control points';
xpack.security.http.filter.deny: _all

As an elasticsearch administrator test; verify runtime environment within
_culster settings are set to '{}' OR Verify all three settings are
xpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:
'Managed access control points'; xpack.security.http.filter.deny: _all

$ curl -h content_type:application-json    -XGET
'http://&lt;elasticsearch&gt;:9200/_cluster/settings'

If these configuration setting are disabled, or not pointing to the 'Managed
access control points', this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26965">
    <title>SRG-APP-000144</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34250r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must implement transaction recovery for systems that are transaction-based.</title>
      <description>&lt;VulnDiscussion&gt;Elasticsearch utilizes a transaction log to ensure the writes are recorded during crash and can be replayed during a recovery phase.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000553</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch utilizes a transaction log to ensure the writes
are recorded during crash and can be replayed during a recovery phase.

This is a permanent not a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26966">
    <title>SRG-APP-000145</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34251r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Backup / Disaster Recovery oriented applications must be capable of backing up user-level information per a defined frequency.</title>
      <description>&lt;VulnDiscussion&gt;As appropriate, backup data within Elasticsearch. Plan and test restoration processes for this information. Utilize snapshot and restore features of elasticsearch.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000535</ident>
      <fixtext fixref="N/A">Setup roles, role mapping, repository, and cron job to faciliate
Backup/ Disaster Recovery including user-level information.

See the official documentation for the guide on roles:
https://www.elastic.co/guide/en/x-pack/current/authorization.html

See the official documentation for the guide on role mapping:
https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-role-mapping.html


See the official documentation for the guide on repository:
https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-snapshots.html


Elasticsearch does not schedule when to perform the snapshot, however, it is
possible to schedule snaphosts with a script.

##### Example Snapshot Script

#!/bin/bash
SNAPSHOT=`date +%Y%m%d-%H%M%S`
REPOSITORY_NAME=&lt;REPOSITORY_NAME&gt;
curl -XPUT
'&lt;elasticsearch&gt;:9200/_snapshot/REPOSITORY_NAME/$SNAPSHOT?wait_for_completion=true'


##### Example Snapshot Script

Schedule this script in cron to run at &lt;ORGANIZATIONAL_DEFINED&gt; frequency.



</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>User-level information is maintained within the standard
backup/restore functionality within the application. A cronjob should be
created to run according to &lt;ORGANIZATIONAL_DEFINED&gt; frequency.

To verify user-level information is stored correctly; as the security
administrator, run the following CURL command:

$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role
$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role_mapping


Review the results, if any results are incorrect or none are defined, this is a
finding.

To verify that a repository; &lt;REPOSITORY_NAME&gt;; is available; as the security
administrator, run the following CURL command:

$ curl -XPOST -H 'Content-Type: application/json' -u
&lt;TEST_USER&gt;:&lt;TEST_CREDENTIALS&gt;
https://&lt;elasticsearch&gt;:9200/_snapshot/&lt;REPOSITORY_NAME&gt;/_verify?pretty=true


Review the results, if error message is returned, this is a finding.

If no script/tool is scheduled to perform a snaphost at the
&lt;ORGANIZATIONAL_DEFINED&gt; frequency, this is a finding.
     </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26967">
    <title>SRG-APP-000106</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34252r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must reject or delay, as defined by the organization, network traffic generated above configurable traffic volume thresholds.</title>
      <description>&lt;VulnDiscussion&gt;Allocate Hard drive space for audit logs for minimum number of days for normal load. Monitor the health and resources (such as remaining storage) of systems running Elasticsearch software and notify operators when safety thresholds have been exceeded. Automated system notification via email or http endpoint can be built as an action in Watcher.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001574</ident>
      <fixtext fixref="N/A">Configure the audit storage to a seperate partition for audit
storage.

Check the system configuration to determine the partition the audit records are
being written to:

# grep log_file /etc/audit/auditd.conf

Determine the size of the partition that audit records are written to (with the
example being '/var/log/elasticsearch/audit/'):

# df -h /var/log/elasticsearch/audit/    </fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Verify the audit records are stored on a seperate disk then
operating system.

Check the system configuration to determine the partition the audit records are
being written to with the following command:

# grep log_file /etc/audit/auditd.conf log_file =
/var/log/elasticsearch/audit/audit.log

Check the size of the partition that audit records are written to (with the
example being '/var/log/elasticsearch/audit/'):

# df -h /var/log/elasticsearch/audit/ 0.9G /var/log/elasticsearch/audit

If the audit records are not being written to a partition specifically created
for audit records (in this example '/var/log/elasticsearch/audit' is a
separate partition), this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26969">
    <title>SRG-APP-000146</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34256r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support and must not impede organizational requirements to conduct backups of system-level information contained in the information system per organization-defined frequency.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000537</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch supports this requirement and cannot be configured to be out of
compliance. This is a permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26971">
    <title>SRG-APP-000147</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34258r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support and must not impede organizational requirements to conduct backups of information system documentation including security-related documentation per organization-defined frequency.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000539</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch supports this requirement and cannot be configured to be out of
compliance. This is a permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26972">
    <title>SRG-APP-000148</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34260r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must uniquely identify and authenticate organizational users (or processes acting on behalf of organizational users).</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000764</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26973">
    <title>SRG-APP-000149</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34261r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must use multifactor authentication for network access to privileged accounts.</title>
      <description>&lt;VulnDiscussion&gt;Within X-Pack Security, a Custom Realm can be implemented that fulfills multifactor authentication. Multifactor checks can be integrated within the single custom realm.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000765</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce multifactor authentication.

Elasticsearch only supports PKI for multifactor authentication; to ensure PKI
is enabled, verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26975">
    <title>SRG-APP-000150</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34263r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must use multifactor authentication for network access to non-privileged accounts.</title>
      <description>&lt;VulnDiscussion&gt;Within X-Pack Security, a Custom Realm can be implemented that fulfills multifactor authentication. Multifactor checks can be integrated within the single custom realm.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000766</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce multifactor authentication.

Elasticsearch only supports PKI for multifactor authentication; to ensure PKI
is enabled, verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26976">
    <title>SRG-APP-000110</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34264r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>To support audit review, analysis and reporting the application must integrate audit review, analysis, and reporting processes to support organizational processes for investigation and response to suspicious activities.</title>
      <description>&lt;VulnDiscussion&gt;Offload and centralize audit records retention to a separate system from the sources of audit records.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000152</ident>
      <fixtext fixref="N/A">Modify the '/etc/rsyslog.conf' file to contain a configuration
line to send all 'rsyslog' output to a log aggregation system:

*.* @@&amp;ltlog aggregation system name&amp;gt

</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Moving audit records to a centralized location will assist in
the investigation and response. Verify 'rsyslog' is configured to send all
messages to a log aggregation server.

Check the configuration of 'rsyslog' with the following command:

# grep @ /etc/rsyslog.conf
   *.* @@logagg.site.mil

If there are no lines in the '/etc/rsyslog.conf' file that contain the '@'
or '@@' symbol(s), and the lines with the correct symbol(s) to send output to
another system do not cover all 'rsyslog' output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26977">
    <title>SRG-APP-000151</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34265r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must use multifactor authentication for local access to privileged accounts.</title>
      <description>&lt;VulnDiscussion&gt;Within X-Pack Security, a Custom Realm can be implemented that fulfills multifactor authentication. Multifactor checks can be integrated within the single custom realm.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000767</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce multifactor authentication.

Elasticsearch only supports PKI for multifactor authentication; to ensure PKI
is enabled, verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26978">
    <title>SRG-APP-000152</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34266r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must use multifactor authentication for local access to non-privileged accounts.</title>
      <description>&lt;VulnDiscussion&gt;Within X-Pack Security, a Custom Realm can be implemented that fulfills multifactor authentication. Multifactor checks can be integrated within the single custom realm.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000768</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce multifactor authentication.

Elasticsearch only supports PKI for multifactor authentication; to ensure PKI
is enabled, verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26980">
    <title>SRG-APP-000154</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34268r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications using multifactor authentication when accessing privileged accounts via the network must provide one of the factors by a device that is separate from the information system gaining access.</title>
      <description>&lt;VulnDiscussion&gt;Within X-Pack Security, a Custom Realm can be implemented that fulfills multifactor authentication. Multifactor checks can be integrated within the single custom realm.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000771</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce multifactor authentication.

Elasticsearch only supports PKI for multifactor authentication; to ensure PKI
is enabled, verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-26981">
    <title>SRG-APP-000155</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34270r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications using multifactor authentication when accessing non-privileged accounts via the network must provide one of the factors by a device separate from the information system gaining access.</title>
      <description>&lt;VulnDiscussion&gt;Within X-Pack Security, a Custom Realm can be implemented that fulfills multifactor authentication. Multifactor checks can be integrated within the single custom realm.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000772</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce multifactor authentication.

Elasticsearch only supports PKI for multifactor authentication; to ensure PKI
is enabled, verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27015">
    <title>SRG-APP-000219</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34309r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Application must ensure  authentication of both client and server during the entire session. An example of this is SSL Mutual Authentication.</title>
      <description>&lt;VulnDiscussion&gt;Configure PKI authentication, TLS/SSL, IP filtering; which are key features of X-Pack Security. This should ensure that authentication and communication within Elasticsearch is SSL Mutual Authentication.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001184</ident>
      <fixtext fixref="N/A">Ensure authentication of both client and server during the entire
session.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to ensure
authentication of both client and server during the entire session..

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true

If this setting is not present or set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27016">
    <title>SRG-APP-000220</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34310r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must terminate user sessions upon user logout or any other organization or policy defined session termination events such as idle time limit exceeded.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001185</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch provides communication through REST API calls and terminates all
session and network communication at the response of every call.  This is a
permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27017">
    <title>SRG-APP-000221</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34311r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications providing a login capability must also provide a logout functionality to allow the user to manually terminate the session.</title>
      <description>&lt;VulnDiscussion&gt;Kibana is a UI presentation layer for elasticsearch. Within the UI the Logout function ends the user's session&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001186</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch provides logout capability through REST API calls and terminates
all session and network communication at the response of every call.  This is a
permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27018">
    <title>SRG-APP-000222</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34312r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must generate a unique session identifier for each session.</title>
      <description>&lt;VulnDiscussion&gt;Utilize shield cluster keys as well as supported clients to prevent hijacking of connections or unexpected contention of updates. Elasticsearch does not have a concept of sessions, but with shield communication ids are unique, random, and signed to prevent tampering.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001187</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch provides a unique session through REST API calls and terminates
all session and network communication at the response of every call through a
network.  This is a permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27019">
    <title>SRG-APP-000223</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34313r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must recognize only system-generated session identifiers.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001664</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch provides a unique session through REST API calls and terminates
all session and network communication at the response of every call.  This is a
permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27020">
    <title>SRG-APP-000224</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34314r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must generate unique session identifiers with organization-defined randomness requirements.</title>
      <description>&lt;VulnDiscussion&gt;Utilize shield cluster keys as well as supported clients to prevent hijacking of connections or unexpected contention of updates. Elasticsearch does not have a concept of sessions, but with shield communication ids are unique, random, and signed to prevent tampering.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001188</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch provides a unique session through REST API calls and terminates
all session and network communication at the response of every call through a
network.  This is a permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27021">
    <title>SRG-APP-000225</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34315r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must be built to fail to a known safe state for defined types of failures.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001190</ident>
      <fixtext fixref="N/A">Elastic components should be installed on multiple physical and
rack seperated machines to ensure application built to handle failures.

See the official documentation for RPM installation at:
https://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch is designed to be deployed across a number of
nodes, across physical machines and racks.  A single elasticsearch node, is
designed to fail, and the cluster is built to handle this failure, replicating
any lost data, updating its system state, and continue processing.

As an elasticsearch administrator test; verify runtime environment within
_culster stats have at least 3 master nodes, 2 data, and replicatoin minimum of
at least 1.

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt;:&lt;TEST_CREDENTIALS&gt;
-XGET 'http://&lt;elasticsearch&gt;:9200/_cluster/stats'
- indices.shards.index.replication.min:1
- nodes.count.total:3
- nodes.count.data:2

If these cluster stats do not meet the mnimum, this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27024">
    <title>SRG-APP-000231</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34318r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must take needed steps to protect data at rest and ensure confidentiality and integrity of application data.</title>
      <description>&lt;VulnDiscussion&gt;If necessary, encrypt data stored by Elasticsearch at rest through the use of operating system controlled, and hardware accelerating file system encryption utilizing key management not governed by the data repository.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001199</ident>
      <fixtext fixref="N/A">For automated/unattended installations, it is possible to use
Kickstart by adding the --encrypted and --passphrase= options to the definition
of each partition to be encrypted. For example, the following line would
encrypt the root partition:
part / --fstype=ext4 --size=100 --onpart=hda1 --encrypted
--passphrase=PASSPHRASE
Any PASSPHRASE is stored in the Kickstart in plaintext, and the Kickstart must
then be protected accordingly. Omitting the --passphrase= option from the
partition definition will cause the installer to pause and interactively ask
for the passphrase during installation.

Detailed information on encrypting partitions using LUKS can be found on the
Red Hat Documentation web site:
https://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/sec-Encryption.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Determine if encryption must be used to protect data on the
system. If encryption must be used and is not employed, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27025">
    <title>SRG-APP-000233</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34319r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must isolate security functions from non-security functions by means of an isolation boundary (implemented via partitions and domains) controlling access to and protecting the integrity of, the hardware, software, and firmware that perform those security functions. The application must isolate security functions from non-security functions.</title>
      <description>&lt;VulnDiscussion&gt;If desired, install Elasticsearch on virtual machines or other container technology to further encapsulate the privileges and resources allocated to the system&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001084</ident>
      <fixtext fixref="N/A">Encapsulate elasticsearch to virtual resources as organiziational
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>If organiziational required, install elasticsearch on virtual
machines or other container technology to further encapsulate the privileges
and resources allocated to the system.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27027">
    <title>SRG-APP-000236</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34321r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must meet organizational requirements to implement an information system isolation boundary that minimizes the number of non-security functions included within the boundary containing security functions.</title>
      <description>&lt;VulnDiscussion&gt;If desired, install Elasticsearch on virtual machines or other container technology to further encapsulate the privileges and resources allocated to the system&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001087</ident>
      <fixtext fixref="N/A">Encapsulate elasticsearch to virtual resources as organiziational
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>If organiziational required, install elasticsearch on virtual
machines or other container technology to further encapsulate the privileges
and resources allocated to the system.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27029">
    <title>SRG-APP-000238</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34323r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must meet organizational requirements to implement security functions as a layered structure minimizing interactions between layers of the design and avoiding any dependence by lower layers on the functionality or correctness of higher layers.</title>
      <description>&lt;VulnDiscussion&gt;If desired, install Elasticsearch on virtual machines or other container technology to further encapsulate the privileges and resources allocated to the system&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001089</ident>
      <fixtext fixref="N/A">Encapsulate elasticsearch to virtual resources as organiziational
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>If organiziational required, install elasticsearch on virtual
machines or other container technology to further encapsulate the privileges
and resources allocated to the system.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27030">
    <title>SRG-APP-000239</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34324r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must protect the integrity of information during the processes of data aggregation, packaging, and transformation in preparation for transmission.</title>
      <description>&lt;VulnDiscussion&gt;Default system checksum are performed at multiple stages of data access, if data is manipulated, the system invalidates the stored data.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001209</ident>
      <fixtext fixref="N/A">Implement protective measures when protecting integrity and
confidentiality.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to protect the
integrity and confidentiality.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27034">
    <title>SRG-APP-000243</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34328r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must prevent unauthorized and unintended information transfer via shared system resources.</title>
      <description>&lt;VulnDiscussion&gt;Separate access to production Elasticsearch systems from developers both at the host operating system, storage subsystems, networks, and Elasticsearch software through Role Based Access Control as required by policy. Access to the internal network of the Elasticsearch cluster should not allow access to production data.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001090</ident>
      <fixtext fixref="N/A">As an administrative users, verify that you have access to
security labels within the data model.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The JSON data models used by a system must maintain
denormalized or linked security labels and markings for information such that
the security labels can be changed by administravtive personnel. Data in
transit is protected via TLS. Utilize X-Pack Security's Field and Document
Level Security features to restrict access based on information within the
document.

As the security administrator, run the following CURL command:

$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is incorrect or does not provide
access to security labels of the underliing data model, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27035">
    <title>SRG-APP-000244</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34329r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must not share resources used to interface with systems operating at different security levels.</title>
      <description>&lt;VulnDiscussion&gt;Limit network access to Elasticsearch software from known points of origin with the use of software and hardware firewalls as well as X-Pack Security IP Filtering. Change the elasticsearch cluster name to an instance unique value for all elasticsearch nodes and transport client nodes in the system.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001091</ident>
      <fixtext fixref="N/A">Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-XXX for
instructions on configuring ES_HOME.

To change the Managed access control points of the application, as the
application administrator, change the following setting in elasticsearch.conf:


$ sudo su - elasticsearch
$ vi $ES_HOME/config/elasticsearch.yml

Change the Managed access control points parameter to the desired addresses,
i.e.:
     xpack.security.http.filter.enabled: true
     xpack.security.http.filter.allow: 'Managed access control points'
     xpack.security.http.filter.deny: _all

Next, restart the application:
$ sudo su - elasticsearch

# SYSTEMD SERVER ONLY
$ systemctl restart elasticsearch</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing IP filtering
rules to verify that only sepecific IP behind hardware/software 'Managed
access control points' are listed.

As the application administrator (usually elasticsearch, check the
xpack.security.http.filter setting contains IP address(es) of the  'Managed
access control points':

$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three
settings; xpack.security.http.filter.enabled: true;
xpack.security.http.filter.allow: 'Managed access control points';
xpack.security.http.filter.deny: _all

As an elasticsearch administrator test; verify runtime environment within
_culster settings are set to '{}' OR Verify all three settings are
xpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:
'Managed access control points'; xpack.security.http.filter.deny: _all

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
 -XGET 'http://&lt;elasticsearch&gt;:9200/_cluster/settings'

If these configuration setting are disabled, or not pointing to the 'Managed
access control points', this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27036">
    <title>SRG-APP-000245</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34330r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must protect against or limit the effects of the organization-defined or referenced types of Denial of Service (DoS) attacks.</title>
      <description>&lt;VulnDiscussion&gt;Utilize network safeguards to limit the ability of Elasticsearch to launch DOS attacks. Dynamic scripting is disabled by default, limiting the ability of an Elasticsearch process to affect resources outside of the Elasticsearch cluster. The snapshot and recovery function of elasticsearch, which can target a URL, should be granted only to the appropriate roles using RBAC privileges (cluster:admin/snapshot/*) and is required to be given a whitelist of targets (repositories.url.allowed_urls).&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001092</ident>
      <fixtext fixref="N/A">Limit the effects of DoS by setting up network safeguards.

See the official documentation for the safeguading of scripts:
https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting-security.html


As the application administrator (usually elasticsearch, check the plugins
folder does not include other scripting languages by running the following:

$ sudo bin/elasticsearch-plugin remove lang-javascript
$ sudo bin/elasticsearch-plugin remove lang-python
</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Utilize network safeguards to limit the ability of
Elasticsearch to launch DOS attacks. Painless, a sandboxed scripting is the
only script enabled by default, limiting the ability of an Elasticsearch
process to affect resources outside of the Elasticsearch cluster.

As the application administrator (usually elasticsearch, check the
script.engine setting do not enable other languages by running the following:


$ cat config/elasticsearch.yml | grep script.engine

This setting should not be present, return true for painless, or false for
javascript, groovy, python, and java.

As the application administrator (usually elasticsearch, check the plugins
folder does not include other scripting languages by running the following:

$ ls &lt;ES_HOME&gt;/plugins/lang-javascript
$ ls &lt;ES_HOME&gt;/plugins/lang-python

If any of these return a response other than 'No such file or directory',
this is a finding.
</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27037">
    <title>SRG-APP-000226</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34331r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must preserve any organization-defined system state information in the event of a system failure.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001665</ident>
      <fixtext fixref="N/A">Elastic components should be installed on multiple physical and
rack seperated machines to ensure application built to handle failures.

See the official documentation for RPM installation at:
https://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch is designed to be deployed across a number of
nodes, across physical machines and racks.  A single elasticsearch node, is
designed to fail, and the cluster is built to handle this failure, replicating
any lost data, updating its system state, and continue processing.

As an elasticsearch administrator test; verify runtime environment within
_culster stats have at least 3 master nodes, 2 data, and replicatoin minimum of
at least 1.

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt;:&lt;TEST_CREDENTIALS&gt;
-XGET 'http://&lt;elasticsearch&gt;:9200/_cluster/stats'
- indices.shards.index.replication.min:1
- nodes.count.total:3
- nodes.count.data:2

If these cluster stats do not meet the mnimum, this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27039">
    <title>SRG-APP-000246</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34333r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must restrict the ability of users to launch Denial of Service (DoS) attacks against other information systems or networks.</title>
      <description>&lt;VulnDiscussion&gt;Utilize network safeguards to limit the ability of Elasticsearch to launch DOS attacks. Dynamic scripting is disabled by default, limiting the ability of an Elasticsearch process to affect resources outside of the Elasticsearch cluster. The snapshot and recovery function of elasticsearch, which can target a URL, should be granted only to the appropriate roles using RBAC privileges (cluster:admin/snapshot/*) and is required to be given a whitelist of targets (repositories.url.allowed_urls).&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001094</ident>
      <fixtext fixref="N/A">Limit the effects of DoS by setting up network safeguards.

See the official documentation for the safeguading of scripts:
https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting-security.html


As the application administrator (usually elasticsearch, check the plugins
folder does not include other scripting languages by running the following:

$ sudo bin/elasticsearch-plugin remove lang-javascript
$ sudo bin/elasticsearch-plugin remove lang-python
</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Utilize network safeguards to limit the ability of
Elasticsearch to launch DOS attacks. Painless, a sandboxed scripting is the
only script enabled by default, limiting the ability of an Elasticsearch
process to affect resources outside of the Elasticsearch cluster.

As the application administrator (usually elasticsearch, check the
script.engine setting do not enable other languages by running the following:


$ cat config/elasticsearch.yml | grep script.engine

This setting should not be present, return true for painless, or false for
javascript, groovy, python, and java.

As the application administrator (usually elasticsearch, check the plugins
folder does not include other scripting languages by running the following:

$ ls &lt;ES_HOME&gt;/plugins/lang-javascript
$ ls &lt;ES_HOME&gt;/plugins/lang-python

If any of these return a response other than 'No such file or directory',
this is a finding.
</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27040">
    <title>SRG-APP-000247</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34334r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must manage excess capacity, bandwidth, or other redundancy to limit the effects of information flooding types of Denial of Service (DoS) attacks.</title>
      <description>&lt;VulnDiscussion&gt;Utilize network safeguards to limit the ability of Elasticsearch to launch DOS attacks. Dynamic scripting is disabled by default, limiting the ability of an Elasticsearch process to affect resources outside of the Elasticsearch cluster. The snapshot and recovery function of elasticsearch, which can target a URL, should be granted only to the appropriate roles using RBAC privileges (cluster:admin/snapshot/*) and is required to be given a whitelist of targets (repositories.url.allowed_urls).&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001095</ident>
      <fixtext fixref="N/A">Limit the effects of DoS by setting up network safeguards.

See the official documentation for the safeguading of scripts:
https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting-security.html


As the application administrator (usually elasticsearch, check the plugins
folder does not include other scripting languages by running the following:

$ sudo bin/elasticsearch-plugin remove lang-javascript
$ sudo bin/elasticsearch-plugin remove lang-python
</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Utilize network safeguards to limit the ability of
Elasticsearch to launch DOS attacks. Painless, a sandboxed scripting is the
only script enabled by default, limiting the ability of an Elasticsearch
process to affect resources outside of the Elasticsearch cluster.

As the application administrator (usually elasticsearch, check the
script.engine setting do not enable other languages by running the following:


$ cat config/elasticsearch.yml | grep script.engine

This setting should not be present, return true for painless, or false for
javascript, groovy, python, and java.

As the application administrator (usually elasticsearch, check the plugins
folder does not include other scripting languages by running the following:

$ ls &lt;ES_HOME&gt;/plugins/lang-javascript
$ ls &lt;ES_HOME&gt;/plugins/lang-python

If any of these return a response other than 'No such file or directory',
this is a finding.
</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27041">
    <title>SRG-APP-000248</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34335r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must limit the use of resources by priority and not impede the host from servicing processes designated as a higher-priority.</title>
      <description>&lt;VulnDiscussion&gt;Elasticsearch is a single process and can be prioritized at the OS level&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001096</ident>
      <fixtext fixref="N/A">Configure elasticsearch service to a lower priority level via
Operating System prioirty settings.

Set the default nice value for the application administrator in the
/etc/security/limits.conf file.

$ sudo su - root
$ vi /etc/security/limits.conf

Set the hard prioirty for the application administrator:
     elasticsearch hard priority 1</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check elasticsearch service priority level via Operating System
prioirty settings. Make sure it is below high-prioirity processes.

As the system administrator (usually root, check the NICE setting is set at 0
or &lt;ORGANIZATIONAL_DETERMINED&gt; level.:

$ ps -efo pid,nice,comm | grep elasticsearch

If this NICE level is lower then 0 or &lt;ORGANIZATIONAL_DETERMINED&gt; level, this
is a finding.
</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27059">
    <title>SRG-APP-NA</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34354r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must maintain the integrity of information during aggregation, packaging, and transformation in preparation for transmission.</title>
      <description>&lt;VulnDiscussion&gt;Use SSL / TLS communication for all networked access to Elasticsearch&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001129</ident>
      <fixtext fixref="N/A">Implement integrity measures during preparation of data
transmission.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to establish
integrity during preparation of data transmission.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27060">
    <title>SRG-APP-NA</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34355r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must protect the confidentiality of transmitted information.</title>
      <description>&lt;VulnDiscussion&gt;Use SSL / TLS communication for all networked access to Elasticsearch and connected components such as Kibana and Logstash.  X-Pack Security should be configured with organization approved cryptography.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001130</ident>
      <fixtext fixref="N/A">Implement confidentiality measures of transmitted data.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to establish
confidentiality of transmitted data.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27061">
    <title>SRG-APP-000264</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34356r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must employ cryptographic mechanisms preventing the unauthorized disclosure of information during transmission unless the transmitted data is otherwise protected by alternative physical measures.</title>
      <description>&lt;VulnDiscussion&gt;Use SSL / TLS communication for all networked access to Elasticsearch and connected components such as Kibana and Logstash.  X-Pack Security should be configured with organization approved cryptography.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001131</ident>
      <fixtext fixref="N/A">Implement protective measures during data transmission.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to protect data
transmission.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27062">
    <title>SRG-APP-000230</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34357r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must maintain the confidentiality of information during aggregation, packaging, and transformation in preparation for transmission. When transmitting data, applications need to leverage transmission protection mechanisms such as TLS, SSL VPNs, or IPSEC.  </title>
      <description>&lt;VulnDiscussion&gt;Use SSL / TLS communication for all networked access to Elasticsearch and connected components such as Kibana and Logstash.  X-Pack Security should be configured with organization approved cryptography.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001132</ident>
      <fixtext fixref="N/A">Implement protective measures during data transmission.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to protect data
transmission.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27063">
    <title>SRG-APP-000251</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34358r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must check the validity of data inputs.</title>
      <description>&lt;VulnDiscussion&gt;Dynamic templates allows for user input to be processed without verifying it against a set of expected values. Turning off dynamic templates, and creating templates for input can handle type validation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001310</ident>
      <fixtext fixref="N/A">Implement protective measures to validate data inputs.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to validate data
input.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27064">
    <title>SRG-APP-000265</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34359r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must identify potentially security-relevant error conditions.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001311</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27066">
    <title>SRG-APP-000267</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34361r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must restrict error messages so only authorized personnel may view them.</title>
      <description>&lt;VulnDiscussion&gt;Limit the access of users and administrators to error logs and verbatim error log messages whether it be in application provided user interfaces or the actual Elasticsearch error log. Ensure production has an appropriate logging information level and is not set to a level left over from development. Secure error logs with OS level protections.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001314</ident>
      <fixtext fixref="N/A">To properly set the owner of audit logs, i.e.
/var/log/elasticsearch/audit, run the command:

 $ sudo chown elasticsearch  /var/log/elasticsearch/audit

To properly set the permissions of audit logs, i.e.
/var/log/elasticsearch/audit, run the command:

$ sudo chmod 0600 /var/log/elasticsearch/audit

To properly set the owner of error logs, i.e. /var/log/elasticsearch/error, run
the command:

$ sudo chown elasticsearch  /var/log/elasticsearch/error

To properly set the permissions of error logs, i.e.
/var/log/elasticsearch/error, run the command:

$ sudo chmod 0600 /var/log/elasticsearch/error  </fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The error logs and audit logs should be restricited to
application owner. i.e. /var/log/elasticsearch/audit folder must have mode 0644
or less permissive for elasticsearch user.

As the application owner, check the permissions of audit logs; i.e.
/var/log/elasticsearch/audit, run the command:

 $ ls -l /var/log/elasticsearch/audit

If properly configured, the output should indicate the following permissions:
-rw------- and the owner should be the application owner. If it does not, this
is a finding.

As the application owner, check the permissions of error logs; i.e.
/var/log/elasticsearch/error, run the command:

 $ ls -l /var/log/elasticsearch/error

If properly configured, the output should indicate the following permissions:
-rw------- and the owner should be the application owner. If it does not, this
is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27067">
    <title>SRG-APP-000268</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34362r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must support the requirement to activate an alarm and/or automatically shut down the information system if an application component failure is detected.  This can include conducting a graceful application shutdown to avoid losing information.</title>
      <description>&lt;VulnDiscussion&gt;Configure automated alarms to proactively notify when the security or stability of the system is threatened&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001328</ident>
      <fixtext fixref="N/A">Elastic components should be installed on multiple physical and
rack seperated machines to ensure application built to handle component
failures.

See the official documentation for RPM installation at:
https://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch is designed to be deployed across a number of
nodes, across physical machines and racks.  A single elasticsearch node, is
designed to fail, and the cluster is built to handle this failure, replicating
any lost data, updating its system state, and continue processing.

As an elasticsearch administrator test; verify runtime environment within
_culster stats have at least 3 master nodes, 2 data, and replicatoin minimum of
at least 1.

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt;:&lt;TEST_CREDENTIALS&gt;
-XGET 'http://&lt;elasticsearch&gt;:9200/_cluster/stats'
- indices.shards.index.replication.min:1
- nodes.count.total:3
- nodes.count.data:2

If these cluster stats do not meet the mnimum, this is a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27073">
    <title>SRG-APP-000111</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34368r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must provide the capability to centralize the review and analysis of audit records from multiple components within the system.</title>
      <description>&lt;VulnDiscussion&gt;Offload and centralize audit records retention to a separate system from the sources of audit records.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000154</ident>
      <fixtext fixref="N/A">Modify the '/etc/rsyslog.conf' file to contain a configuration
line to send all 'rsyslog' output to a log aggregation system:

*.* @@&amp;ltlog aggregation system name&amp;gt

</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Verify 'rsyslog' is configured to send all messages to a log
aggregation server.

Check the configuration of 'rsyslog' with the following command:

# grep @ /etc/rsyslog.conf
   *.* @@logagg.site.mil

If there are no lines in the '/etc/rsyslog.conf' file that contain the '@'
or '@@' symbol(s), and the lines with the correct symbol(s) to send output to
another system do not cover all 'rsyslog' output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27085">
    <title>SRG-APP-000113</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34380r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must provide an audit reduction capability.</title>
      <description>&lt;VulnDiscussion&gt;Automate the creation of reports, dashboards, and interactive exploration of audit records.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000156</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to contain sufficient
information to establish where an event occured.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records to
verify information specific to the nessacary content of the event is being
captured and stored with audit records.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27089">
    <title>SRG-APP-000114</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34384r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must provide a report generation capability for audit reduction data.</title>
      <description>&lt;VulnDiscussion&gt;Automate the creation of reports, dashboards, and interactive exploration of audit records.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000157</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings based on selectable, event
criteria.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

As the system administrator, change the permissions of ES_HOME.

$ sudo chown -R elasticsearch:elasticsearch ${ES_HOME?}
$ sudo chmod 700 ${ES_HOME?}




</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-F for instructions on configuring
ES_HOME.

$ cat config/elasticsearch.yml | grep xpack.security.audit

Check elasticsearch settings and documentation to determine whether designated
personnel are able to select which auditable events are being audited.


As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27092">
    <title>SRG-APP-000282</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34387r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>For those instances where the organization requires encrypted traffic to be visible to information system monitoring tools, the application transmitting the encrypted traffic must make provisions to allow that traffic to be visible to specific system monitoring tools.</title>
      <description>&lt;VulnDiscussion&gt;Use SSL / TLS communication for all networked access to Elasticsearch and connected components such as Kibana and Logstash.  X-Pack Security should be configured with organization approved cryptography.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001272</ident>
      <fixtext fixref="N/A">Implement protective measures when enforcing password encryption
for transmission.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to protect
passwords in transmission.
As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:

If this setting is set to false, this is a finding.

$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:

If this setting is set to false, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27114">
    <title>SRG-APP-000186</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34411r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must terminate all sessions and network connections when non-local maintenance is completed.</title>
      <description>&lt;VulnDiscussion&gt;Cluster shutdown will end all session and network connection&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000879</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch provides non-local maintenance through REST API calls and
terminates all session and network communication at the response of every call
through a network.  This is a permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27120">
    <title>SRG-APP-000188</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34417r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must support organizational requirements to employ cryptographic mechanisms to protect information in storage.</title>
      <description>&lt;VulnDiscussion&gt;If necessary, encrypt data stored by Elasticsearch at rest through the use of operating system controlled, and hardware accelerating file system encryption utilizing key management not governed by the data repository.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001019</ident>
      <fixtext fixref="N/A">For automated/unattended installations, it is possible to use
Kickstart by adding the --encrypted and --passphrase= options to the definition
of each partition to be encrypted. For example, the following line would
encrypt the root partition:
part / --fstype=ext4 --size=100 --onpart=hda1 --encrypted
--passphrase=PASSPHRASE
Any PASSPHRASE is stored in the Kickstart in plaintext, and the Kickstart must
then be protected accordingly. Omitting the --passphrase= option from the
partition definition will cause the installer to pause and interactively ask
for the passphrase during installation.

Detailed information on encrypting partitions using LUKS can be found on the
Red Hat Documentation web site:
https://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/sec-Encryption.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Determine if encryption must be used to protect data on the
system. If encryption must be used and is not employed, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27128">
    <title>SRG-APP-000190</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34426r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must terminate the network connection associated with a communications session at the end of the session or after an organization-defined time period of inactivity.</title>
      <description>&lt;VulnDiscussion&gt;Elasticsearch does not have sessions that need to be timed out, but configure Elasticsearch tcp socket keepalive settings to organizational mandates. And configure applications to use an appropriate scroll api in the _search API's for scroll time window to prevent bloat of server side resources.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001133</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch provides communication through REST API calls and terminates all
session and network communication at the response of every call through a
network.  This is a permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27130">
    <title>SRG-APP-000191</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34428r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must establish a trusted communications path between the user and organization-defined security functions within the information system.</title>
      <description>&lt;VulnDiscussion&gt;Use SSL / TLS communication for all networked access to Elasticsearch and connected components such as Kibana and Logstash.  X-Pack Security should be configured with organization approved cryptography.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001135</ident>
      <fixtext fixref="N/A">Implement protective measures when establishing a trusted
communication path between entities.

 See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to protect the
communication path between entities.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true

If this setting is not present or set to true, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27135">
    <title>SRG-APP-000263</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34434r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must provide automated support for the management of distributed security testing.</title>
      <description>&lt;VulnDiscussion&gt;Present the human readable, organization defined security labels on all information transmitted from Elasticsearch either in the original records or information products derived from that information so that it can be appropriately handled by other systems or as a derived dataset within Elasticsearch&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001295</ident>
      <fixtext fixref="N/A">As a data owner, build a data model that is denormalized or
linked security labels and markings for information such that the information
can be used for distributed security testing.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The JSON data models used by a system must maintain
denormalized or linked security labels and markings for information such that
the information can be used for safeguarding information. Data in transit is
protected via TLS. Utilize X-Pack Security's Field and Document Level Security
features to restrict access based on information within the document.

As the elasticsearch administrator, run the following CURL command:

$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is incorrect or provices access to
cluster configuration outside of administration roles, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27137">
    <title>SRG-APP-000262</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34436r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications utilized for integrity verification must detect unauthorized changes to software and information.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001297</ident>
      <fixtext fixref="N/A">Install the AIDE package with the command:

$ sudo yum install aide</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The AIDE package must be installed if it is to be available for
integrity checking.

Run the following command to determine if the aide package is installed:

$ rpm -q aide

If the package is not installed, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27140">
    <title>SRG-APP-000196</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34439r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must implement required cryptographic protections using cryptographic modules complying with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.</title>
      <description>&lt;VulnDiscussion&gt;Configure X-Pack Security to use an organization approved FIPS 140-2 java cryptography provider.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001144</ident>
      <fixtext fixref="N/A">Employ approved cryptography that complying with applicable
federal laws, Executive Orders, directives, policies, regulations, standards,
and guidance.

See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography that complying
with applicable federal laws, Executive Orders, directives, policies,
regulations, standards, and guidance.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:

If this setting is not present, or not set to FIPS-validated or NSA-approved
cryptography, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27145">
    <title>SRG-APP-000115</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34444r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must provide the capability to automatically process audit records for events of interest based upon selectable, event criteria.</title>
      <description>&lt;VulnDiscussion&gt;Deploy security analytics to monitor the behavior of system users and administrators. Audit events should be exportable, searchable, filterable, and summarized in real time.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000158</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings based on selectable, event
criteria.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-F for instructions on configuring
ES_HOME.

$ cat config/elasticsearch.yml | grep xpack.security.audit

Check elasticsearch settings and documentation to determine whether designated
personnel are able to select which auditable events are being audited.


As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27146">
    <title>SRG-APP-000116</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34445r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must use internal system clocks to generate time stamps for audit records.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000159</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The Elasticsearch application's auditing system supports this
requirement and cannot be configured to be out of compliance. Every audit
record in elasticsearch includes a timestamp.

This is a permanent not a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27147">
    <title>SRG-APP-000117</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34446r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must synchronize with internal information system clocks which in turn, are synchronized on an organization-defined frequency with an organization-defined authoritative time source. </title>
      <description>&lt;VulnDiscussion&gt;Synchronize operating system clocks with an organizational authoritative source using NTP.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000160</ident>
      <fixtext fixref="N/A">Depending on specific functional requirements of a concrete production
   environment, the Red Hat Enterprise Linux 7 Server system can be configured to 
   utilize the services of the chronyd NTP daemon (the default), or services of the
   ntpd NTP daemon. 
   Refer to https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/ch-Configuring_NTP_Using_the_chrony_Suite.html for more detailed comparison of the features of both of the choices, and for further guidance how to choose between the two NTP daemons.

To specify a remote NTP server for time synchronization, perform the following:

* if the system is configured to use the chronyd as the NTP daemon (the default),
 edit the file /etc/chrony.conf as follows,

* if the system is configured to use the ntpd as the NTP daemon, edit the file 
/etc/ntp.conf as documented below.

Add or correct the following lines, substituting the IP or hostname of a remote 
NTP server for ntpserver:

server ntpserver

This instructs the NTP software to contact that remote server to obtain time data.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>To verify that a remote NTP service is configured for time
synchronization, open the following file:

/etc/chrony.conf

in the case the system in question is configured to use the chronyd as the NTP
daemon (default setting)

/etc/ntp.conf

 in the case the system in question is configured to use the ntpd as the NTP
daemon

In the file, there should be a section similar to the following:

server ntpserver

If this is not the case, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27148">
    <title>SRG-APP-000118</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34447r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must protect audit information from any type of unauthorized access.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000162</ident>
      <fixtext fixref="N/A">The owner of all log files written by the application should be
elasticsearch. These log files are determined by the
xpack.security.audit.output parameter in elasticsearch.yml and typically all
appear in /var/log/elasticsearch/audit.

For each log file LOGFILE referenced in xpack.security.audit.output from
elasticsearch.yml, run the following command to inspect the file's owner:

$ ls -l LOGFILE

If the owner is not elasticsearch, run the following command to correct this:

$ sudo chown elasticsearch LOGFILE</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The owner of all log files written by the application should be
elasticsearch. These log files are determined by the
xpack.security.audit.output paramter in elasticsearch.yml and typically all
appear in /var/log/elasticsearch/audit. To see the owner of a given log file,
run the following command:

$ ls -l LOGFILE

If the owner is not root, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27150">
    <title>SRG-APP-000197</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34449r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must employ FIPS-validated cryptography to protect unclassified information.</title>
      <description>&lt;VulnDiscussion&gt;Configure X-Pack Security to use an organization approved FIPS 140-2 java cryptography provider.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001145</ident>
      <fixtext fixref="N/A">Employ approved cryptography to protect unclassified information.


See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to protect
unclassified information.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:

If this setting is not present, or not set to FIPS-validated or NSA-approved
cryptography, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27152">
    <title>SRG-APP-000119</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34451r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must protect audit information from unauthorized modification.</title>
      <description>&lt;VulnDiscussion&gt;Offload and centralize audit records retention to a separate system from the sources of audit records.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000163</ident>
      <fixtext fixref="N/A">Modify the '/etc/rsyslog.conf' file to contain a configuration
line to send all 'rsyslog' output to a log aggregation system:

*.* @@&amp;ltlog aggregation system name&amp;gt

</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Moving audit information off of the systems creating the audit
events protects the information from unauthorized modification. Verify
'rsyslog' is configured to send all messages to a log aggregation server.

Check the configuration of 'rsyslog' with the following command:

# grep @ /etc/rsyslog.conf
   *.* @@logagg.site.mil

If there are no lines in the '/etc/rsyslog.conf' file that contain the '@'
or '@@' symbol(s), and the lines with the correct symbol(s) to send output to
another system do not cover all 'rsyslog' output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27153">
    <title>SRG-APP-000198</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34452r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must employ NSA-approved cryptography to protect classified information.</title>
      <description>&lt;VulnDiscussion&gt;Configure X-Pack Security to use an organization approved FIPS 140-2 java cryptography provider.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001146</ident>
      <fixtext fixref="N/A">Employ approved cryptography to protect classified information.


See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to protect
classified information.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:

If this setting is not present, or not set to FIPS-validated or NSA-approved
cryptography, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27154">
    <title>SRG-APP-000199</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34453r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must employ FIPS-validated cryptography to protect unclassified information when such information must be separated from individuals who have the necessary clearances yet lack the necessary access approvals.</title>
      <description>&lt;VulnDiscussion&gt;Configure X-Pack Security to use an organization approved FIPS 140-2 java cryptography provider.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001147</ident>
      <fixtext fixref="N/A">Employ approved cryptography for data seperations.

See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography for data
seperation.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:

If this setting is not present, or not set to FIPS-validated or NSA-approved
cryptography, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27155">
    <title>SRG-APP-NA</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34454r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must employ FIPS-validated or NSA-approved cryptography to implement digital signatures.</title>
      <description>&lt;VulnDiscussion&gt;Configure X-Pack Security to use an organization approved FIPS 140-2 java cryptography provider.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001148</ident>
      <fixtext fixref="N/A">Employ approved cryptography to implment digital signatures.


See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must utilize approved cryptography to establish
implement digital signatures.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to the correct values.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these setting are not set or the underlining certificate and keys are not
correct, this is a finding.

$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:

If this setting is not present, or not set to FIPS-validated or NSA-approved
cryptography, this is a finding.

As a elasticsearch user, check that non-secure http traffic does not response
with 200 status:

$curl -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p &lt;TEST_CREDENTIALS&gt;
http://&lt;elasticsearchIP:9200&gt;/

If a 200 response comes back, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27159">
    <title>SRG-APP-000201</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34458r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must protect the integrity and availability of publicly available information and applications.</title>
      <description>&lt;VulnDiscussion&gt;Prevent tampering for publicly available information sets by setting read-only access for application or anonymous access, as appropriate.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001149</ident>
      <fixtext fixref="N/A">Enforce the protection needs of public infomraiton in the same
manner as normal access restrictions.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch enforces access restrictions based on Role Based
Acces Control. Other access controls should be handled by the Operating System.


As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

As the elasticsearch administrator, run the following CURL command:

$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is incorrect or provices access to
cluster configuration outside of administration roles, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27160">
    <title>SRG-APP-000120</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34459r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must protect audit information from unauthorized deletion.</title>
      <description>&lt;VulnDiscussion&gt;Configure operating system protections for audit records such that the records are not editable or deletable by Elasticsearch administrators and not accessible by unauthorized users.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000164</ident>
      <fixtext fixref="N/A">To properly set the permissions of /var/log/elasticsearch/audit,
run the command:

$ sudo chmod 0644 /var/log/elasticsearch/audit  </fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The /var/log/elasticsearch/audit folder must have mode 0644 or
less permissive.

To check the permissions of /var/log/elasticsearch/audit, run the command:

 $ ls -l /var/log/elasticsearch/audit

If properly configured, the output should indicate the following permissions:
-rw-r--r-- If it does not, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27163">
    <title>SRG-APP-000121</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34462r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must protect audit tools from unauthorized access.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001493</ident>
      <fixtext fixref="N/A">The owner of all log files written by the application should be
elasticsearch. These log files are determined by the
xpack.security.audit.output parameter in elasticsearch.yml and typically all
appear in /var/log/elasticsearch/audit.

For each log file LOGFILE referenced in /etc/rsyslog.conf, run the following
command to inspect the file's owner:

$ ls -l LOGFILE

If the owner is not elasticsearch, run the following command to correct this:

$ sudo chown elasticsearch LOGFILE</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The owner of all log files written by the application should be
elasticsearch. These log files are determined by the
xpack.security.audit.output paramter in elasticsearch.yml and typically all
appear in /var/log/elasticsearch/audit. To see the owner of a given log file,
run the following command:

$ ls -l LOGFILE

If the owner is not root, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27164">
    <title>SRG-APP-000122</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34463r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must protect audit tools from unauthorized modification.</title>
      <description>&lt;VulnDiscussion&gt;Utilize perimeter, application, centralized authentication, and repository audit controls to audit the use of systems in real time with sufficient context.  X-Pack Security audit controls should be enabled to audit the defaults of all HTTP/S based access to Elasticsearch.  All applications should use HTTP/S  rather than Elasticsearch transport protocol. Implement OS level access controls on audit logs. Move audit logs off of elasticsearch systems and into central audit logging solution.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001494</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to be controlled by
authorized users.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Note: The following instructions use the ES_HOME environment
variable. See supplementary content APPENDIX-F for instructions on configuring
ES_HOME.

$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs


Check elasticsearch settings and documentation to determine whether designated
personnel are able to access audit settings.

As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27165">
    <title>SRG-APP-000123</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34464r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must protect audit tools from unauthorized deletion.</title>
      <description>&lt;VulnDiscussion&gt;Configure operating system protections for audit records such that the records are not editable or deletable by Elasticsearch administrators and not accessible by unauthorized users. Move audit logs off of local machines and backup to a audit log management system.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001495</ident>
      <fixtext fixref="N/A">To properly set the owner of /etc/shadow, run the command:

$ sudo chown elasticsearch elasticsearch.yml    --           ##   TODO add text
around adding rule </fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The elasticsearch.yml file controls audit function for the
application. Protection of this file is critical for system security.

To check the ownership of elasticsearch.yml, run the command:

 $ ls -lL ES_HOME/elasticsearch.yml

If properly configured, the output should indicate the following owner:
elasticsearch If it does not, this is a finding.

The elasticsearch.yml must have mode 0640 or less permissive.

To check the permissions of elasticsearch.yml, run the command:

 $ ls -l ES_HOME/elasticsearch.yml

If properly configured, the output should indicate the following permissions:
-rw-r--r-- If it does not, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27166">
    <title>SRG-APP-000124</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34465r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must have the capability to produce audit records on hardware-enforced, write-once media.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000165</ident>
      <fixtext fixref="N/A">This requirement is NA. No fix is required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch cannot support this requirement without
assistance from an external application, policy, or service. This requirement
is NA.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27168">
    <title>SRG-APP-000125</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34467r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must support the requirement to back up audit data and records onto a different system or media than the system being audited on an organization-defined frequency.</title>
      <description>&lt;VulnDiscussion&gt;Offload and centralize audit records retention to a separate system from the sources of audit records.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001348</ident>
      <fixtext fixref="N/A">Configure elasticsearch audit settings to an external system or
media.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Check Elasticsearch.yml settings and existing audit records are
being recorded to an external system or media.

As the application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.  If this
configuration setting does not contain logfile, this is a finding.

For a complete list of extra information that can be added to log_line_prefix,
see the official documentation:
https://www.elastic.co/guide/en/x-pack/current/auditing.html

 If the current settings do not provide enough information regarding the
content of the event, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27170">
    <title>SRG-APP-000203</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34469r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must associate security attributes with information exchanged between information systems.</title>
      <description>&lt;VulnDiscussion&gt;The JSON data models used by a system must maintain denormalized or linked security labels and markings for information such that the information can be used for automated policy actions by applications and Elasticsearch security infrastructure. Utilize X-Pack Security's Field and Document Level Security features to restrict access based on information within the document.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001157</ident>
      <fixtext fixref="N/A">As a data owner, build a data model that is denormalized or
linked security labels and markings for information such that the information
can be used for automated policy actions by applications and Elasticsearch
security infrastructure.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>The JSON data models used by a system must maintain
denormalized or linked security labels and markings for information such that
the information can be used for automated policy actions by applications and
Elasticsearch security infrastructure. Data in transit is protected via TLS.
Utilize X-Pack Security's Field and Document Level Security features to
restrict access based on information within the document.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27171">
    <title>SRG-APP-000204</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34470r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must validate the integrity of security attributes exchanged between systems.</title>
      <description>&lt;VulnDiscussion&gt;The application controlled data model for security labels and markings should be human readable and present in all stored and transferred data models.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001158</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Elasticsearch supports this requirement and cannot be configured to be out of
compliance. This is a permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27172">
    <title>SRG-APP-000205</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34471r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must support organizational requirements to issue public key certificates under an appropriate certificate policy or obtain public key certificates under an appropriate certificate policy from an approved service provider.</title>
      <description>&lt;VulnDiscussion&gt;Configure PKI authentication, TLS/SSL, IP filtering; which are key features of X-Pack Security. This should ensure that authentication and communication within Elasticsearch utilizes organizational attained certificates.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001159</ident>
      <fixtext fixref="N/A">Revoke trust in any certificates not issued by a DoD-approved
certificate authority.

Configure Elasticsearch to accept only DoD and DoD-approved PKI end-entity
certificates. Verify that xpack.ssl.certificate_authorities is pointing to the
trusted certificate authority from an approved service providoer.

See the official documentation for the complete  guide on establishing SSL
configuration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Application must obtain public key certificates from an
apporved service provider.

As the application administrator (usually elasticsearch), check the xpack.ssl
settings are set to approved public key certificates.

$cat elasticsearch.yml | grep xpack.ssl

xpack.ssl.key:                     &lt;server_key&gt;.key
xpack.ssl.certificate:             &lt;server_certificate&gt;.crt
xpack.ssl.certificate_authorities: [ &lt;approved_ca&gt;.crt' ]

If these certificates are not approved certificates, this is a finding.  </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-27178">
    <title>SRG-APP-000211</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-34477r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must separate user functionality (including user interface services) from information system management functionality.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001082</ident>
      <fixtext fixref="N/A">Integrating a Proxy or API gateway in front of elasticsearch REST
API will allow you to seperate user functions from system management functions.


This is different then Access to the system managemnet functions, as the access
can be controlled by X-Pack Role based Access Controls.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch cannot support this requirement without
assistance from an external application, policy, or service.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-29188">
    <title>SRG-APP-000232</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-37459r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications handling data requiring 'data at rest' protections must employ cryptographic mechanisms to prevent unauthorized disclosure and modification of the information that is at rest unless otherwise protected by alternative physical measures.</title>
      <description>&lt;VulnDiscussion&gt;If necessary, encrypt data stored by Elasticsearch at rest through the use of operating system controlled, and hardware accelerating file system encryption utilizing key management not governed by the data repository.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001200</ident>
      <fixtext fixref="N/A">For automated/unattended installations, it is possible to use
Kickstart by adding the --encrypted and --passphrase= options to the definition
of each partition to be encrypted. For example, the following line would
encrypt the root partition:
part / --fstype=ext4 --size=100 --onpart=hda1 --encrypted
--passphrase=PASSPHRASE
Any PASSPHRASE is stored in the Kickstart in plaintext, and the Kickstart must
then be protected accordingly. Omitting the --passphrase= option from the
partition definition will cause the installer to pause and interactively ask
for the passphrase during installation.

Detailed information on encrypting partitions using LUKS can be found on the
Red Hat Documentation web site:
https://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/sec-Encryption.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Determine if encryption must be used to protect data on the
system. If encryption must be used and is not employed, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-29189">
    <title>SRG-APP-000235</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-37460r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>Applications must isolate security functions enforcing access and information flow control from both non-security functions and from other security functions.</title>
      <description>&lt;VulnDiscussion&gt;Isolate security functions from non security functions with the use of RBAC under the principle of least privilege. Administration users should not be granted roles and privileges beyond what is necessary to administer the system.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001086</ident>
      <fixtext fixref="N/A">Enforce logical access restrictions with changes to application
configuration.

See the official documentation for the complete  guide on authorization
configuration:
https://www.elastic.co/guide/en/x-pack/current/authorization.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Design the domains of administration roles within Elasticsearch
by the principle of Separation of Duties.

As the application administrator (shown here as 'elasticsearch'), verify the
permissions for ES_HOME:

$ ls -la ${ES_HOME?}

If anything in ES_HOME is not owned by the application administrator, this is a
finding.

Next, as the elasticsearch administrator, run the following CURL command:


$ curl -XGET  -H 'Content-Type: application/json' -u &lt;TEST_USER&gt; -p
&lt;TEST_CREDENTIALS&gt; https://&lt;elasticsearch&gt;:9200/_xpack/security/role

Review the role permissions, if any role is listed as superuser but should not
have that access, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-30570">
    <title>SRG-APP-000140</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-40299r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must enforce requirements for remote connections to the information system.</title>
      <description>&lt;VulnDiscussion&gt;Limit access inbound and outbound access to Elasticsearch over networks using software and hardware firewall rules. Disable zen multicast discovery, and enable unicast only to known elasticsearch cluster nodes.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-000066</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html


Configure elasticsearch audit settings to contain sufficient information to
monitor for unauthorized access.

See the official documentation for the instructions on audit configuration:
https://www.elastic.co/guide/en/x-pack/current/auditing.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Verify that external authenitcation mechianism is in place,
LDAP, Active Directory, or PKI and verify auditing is setup.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.  As the
application administrator (usually elasticsearch, check the
xpack.security.audit.outputs setting contains logfile by running the following:


$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs

If this configuration setting is not present, this is a finding.

If this configuration setting does not contain logfile, this is a finding.     </check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-30574">
    <title>SRG-APP-000234</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-40308r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The information system must automatically terminate emergency accounts after an organization-defined time period for each type of account.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001682</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-30575">
    <title>SRG-APP-000291</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-40309r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must notify appropriate individuals when accounts are created.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001683</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-30576">
    <title>SRG-APP-000292</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-40310r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must notify appropriate individuals when accounts are modified.</title>
      <description>&lt;VulnDiscussion&gt;Configure the centralized authentication service to enforce organization policies such as password strength, lockout, expiration, notification, and screen obfuscation.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001684</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-30582">
    <title>SRG-APP-000293</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-40322r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must notify appropriate individuals when account disabling actions are taken.</title>
      <description>&lt;VulnDiscussion&gt;Configure the Elasticsearch cluster to use a centralized authentication and authorization service such as Active Directory or LDAP in order to comply with organization defined management policies.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001685</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-30583">
    <title>SRG-APP-000294</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-40323r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must notify appropriate individuals when accounts are terminated.</title>
      <description>&lt;VulnDiscussion&gt;Configure the Elasticsearch cluster to use a centralized authentication and authorization service such as Active Directory or LDAP in order to comply with organization defined management policies.&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001686</ident>
      <fixtext fixref="N/A">Configure elasticsearch realms settings to point to organization
supported authentication mechanism

See the official documentation for the instructions on realm configuration:
https://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Guidance in Appendix B - System accounts cannot be disabled and
elasticsearch does not enforce password complexity rules.

Elasticsearch supports LDAP, Active Directory, and PKI.

If the external authentication is Active Directory; verify the following
settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?active_directory'


 xpack:
  security:
    authc:
      realms:
        active_directory:
          type: active_directory
          order: 0
          domain_name: ad.example.com
          url: ldaps://ad.example.com:636
          unmapped_groups_as_roles: true | false

If these settings are not correct or missing, this is a finding.

If the external authentication is LDAP; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \?ldap'

xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: 'ldaps://ldap.example.com:636'
          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'
          bind_password: changeme
          user_search:
            base_dn: 'dc=example,dc=com'
            attribute: cn
          group_search:
            base_dn: 'dc=example,dc=com'
          files:
            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml

If these settings are not correct or missing, this is a finding.

If the external authentication is PKI; verify the following settings.

$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \?pki'

 xpack:
  security:
    authc:
      realms:
        pki1:
          type: pki
          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'

If these settings are not correct or missing, this is a finding.

</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="V-30589">
    <title>SRG-APP-000290</title>
    <description>&lt;GroupDescription&gt;N/A&lt;/GroupDescription&gt;</description>
    <Rule id="SV-40333r1_rule" severity="medium" weight="N/A">
      <version>N/A</version>
      <title>The application must use cryptographic mechanisms to protect the integrity of audit tools.</title>
      <description>&lt;VulnDiscussion&gt;N/A&lt;/VulnDiscussion&gt;</description>
      <reference>
        <dc:title>DPMS Target Elasticsearch 5.x</dc:title>
        <dc:publisher>DISA</dc:publisher>
        <dc:type>DPMS Target</dc:type>
        <dc:subject>Elasticsearch 5.x</dc:subject>
        <dc:identifier>3087</dc:identifier>
      </reference>
      <ident system="http://iase.disa.mil/cci">CCI-001496</ident>
      <fixtext fixref="N/A">This requirement is a permanent not a finding. No fix is
required.</fixtext>
      <fix id="N/A"/>
      <check system="N/A">
        <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Elasticsearch_5-x_STIG.xml"/>
        <check-content>Elasticsearch meets this requirement through design and
implementation.

Please refer to guidelines at
https://www.elastic.co/guide/en/elasticsearch/reference/master/rpm.html#rpm-key


Elasticsearch supports this requirement and cannot be configured to be out of
compliance. This is a permanent not a finding. </check-content>
      </check>
    </Rule>
  </Group>
</Benchmark>
